<!DOCTYPE HTML>
<html>
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <script id="sap-ui-bootstrap" 
      type="text/javascript"
      src="../../../../../resources/sap-ui-core.js"
      data-sap-ui-theme="sap_bluecrystal"
      data-sap-ui-libs="sap.ui.core,sap.ui.commons,sap.ui.table" >
    </script>
    <link rel="stylesheet" href="../../../../../resources/sap/ui/thirdparty/qunit.css" type="text/css" media="screen" />
    <script type="text/javascript" src="../../../../../resources/sap/ui/thirdparty/qunit.js"></script>
    <script type="text/javascript" src="../../../../../resources/sap/ui/qunit/qunit-junit.js"></script>
    
    <script type="text/javascript" src="../../../../../resources/sap/ui/qunit/QUnitUtils.js"></script>
    
    <script  language="javascript">

	var oTable = new sap.ui.table.DataTable();
	oTable.setFirstVisibleRow(9);
	oTable.setExpandedVisibleRowCount(20);
	oTable.setTitle("DataTable");
	oTable.setSelectionMode(sap.ui.table.SelectionMode.All);
	oTable.setToolbar(new sap.ui.commons.Toolbar({items: [ 
	    new sap.ui.commons.Button({text: "Button", press: function() {}})
	]}));

	var personImg = "../images/Person.png";
	var jobPosImg = "../images/JobPosition.png";
	
	var aData = [
		{lastName: "Dente", name: "Al", checked: true, linkText: "www.sap.com", href: "http://www.sap.com", src: personImg, gender: "male", rating: 4},
		{lastName: "Friese", name: "Andy", checked: true, linkText: "www.spiegel.de", href: "http://www.spiegel.de", src: jobPosImg, gender: "male", rating: 2},
		{lastName: "Mann", name: "Anita", checked: false, linkText: "www.kicker.de", href: "http://www.kicker.de", src: personImg, gender: "female", rating: 3},
		{lastName: "Schutt", name: "Doris", checked: true, linkText: "www.spiegel.de", href: "http://www.spiegel.de", src: personImg, gender: "female", rating: 4},
		{lastName: "Open", name: "Doris", checked: true, linkText: "www.spiegel.de", href: "http://www.spiegel.de", src: personImg, gender: "female", rating: 2},
		{lastName: "Dewit", name: "Kenya", checked: false, linkText: "www.spiegel.de", href: "http://www.spiegel.de", src: personImg, gender: "female", rating: 3},
		{lastName: "Zar", name: "Lou", checked: true, linkText: "www.spiegel.de", href: "http://www.spiegel.de", src: personImg, gender: "male", rating: 1},
		{lastName: "Burr", name: "Tim", checked: true, linkText: "www.spiegel.de", href: "http://www.spiegel.de", src: jobPosImg, gender: "male", rating: 2},
		{lastName: "Hughes", name: "Tish", checked: true, linkText: "www.spiegel.de", href: "http://www.spiegel.de", src: personImg, gender: "male", rating: 5},
		{lastName: "Town", name: "Mo", checked: true, linkText: "www.spiegel.de", href: "http://www.spiegel.de", src: personImg, gender: "male", rating: 3},
		{lastName: "Case", name: "Justin", checked: false, linkText: "www.sap.com", href: "http://www.sap.com", src: personImg, gender: "male", rating: 3},
		{lastName: "Time", name: "Justin", checked: true, linkText: "www.spiegel.de", href: "http://www.spiegel.de", src: personImg, gender: "male", rating: 4},
		{lastName: "Barr", name: "Sandy", checked: true, linkText: "www.spiegel.de", href: "http://www.spiegel.de", src: personImg, gender: "male", rating: 2},
		{lastName: "Poole", name: "Gene", checked: true, linkText: "www.spiegel.de", href: "http://www.spiegel.de", src: jobPosImg, gender: "male", rating: 1},
		{lastName: "Ander", name: "Corey", checked: false, linkText: "www.spiegel.de", href: "http://www.spiegel.de", src: personImg, gender: "male", rating: 5},
		{lastName: "Early", name: "Brighton", checked: true, linkText: "www.spiegel.de", href: "http://www.spiegel.de", src: personImg, gender: "male", rating: 3},
		{lastName: "Noring", name: "Constance", checked: true, linkText: "www.sap.com", href: "http://www.sap.com", src: personImg, gender: "female", rating: 4},
		{lastName: "O'Lantern", name: "Jack", checked: true, linkText: "www.spiegel.de", href: "http://www.spiegel.de", src: personImg, gender: "male", rating: 2},
		{lastName: "Tress", name: "Matt", checked: true, linkText: "www.spiegel.de", href: "http://www.spiegel.de", src: jobPosImg, gender: "male", rating: 4},
		{lastName: "Turner", name: "Paige", checked: true, linkText: "www.spiegel.de", href: "http://www.spiegel.de", src: personImg, gender: "female", rating: 3}
	];
											
	var oControl = new sap.ui.commons.TextView().bindProperty("text", "lastName");
	oTable.addColumn(new sap.ui.table.Column({label: new sap.ui.commons.Label({text: "Last Name"}), template: oControl, sortProperty: "lastName", filterProperty: "lastName", width: "200px"}));
	oControl = new sap.ui.commons.TextField().bindProperty("value", "name");
	oTable.addColumn(new sap.ui.table.Column({label: new sap.ui.commons.Label({text: "First Name"}), template: oControl, sortProperty: "name", filterProperty: "name", width: "100px"}));
	oControl = new sap.ui.commons.CheckBox().bindProperty("checked", "checked");
 	oTable.addColumn(new sap.ui.table.Column({label: new sap.ui.commons.Label({text: "Checked"}), template: oControl, sortProperty: "checked", filterProperty: "checked", width: "75px", hAlign: "Center"}));
	oControl = new sap.ui.commons.Link().bindProperty("text", "linkText").bindProperty("href", "href");
	oTable.addColumn(new sap.ui.table.Column({label: new sap.ui.commons.Label({text: "Web Site"}), template: oControl, sortProperty: "linkText", filterProperty: "linkText"}));
	oControl = new sap.ui.commons.Image().bindProperty("src", "src");
	oTable.addColumn(new sap.ui.table.Column({label: new sap.ui.commons.Label({text: "Image"}), template: oControl, width: "75px", hAlign: "Center"}));
	oControl = new sap.ui.commons.ComboBox().bindProperty("value","gender");
	oTable.addColumn(new sap.ui.table.Column({label: new sap.ui.commons.Label({text: "Gender"}), template: oControl, sortProperty: "gender", filterProperty: "gender"}));
	oControl = new sap.ui.commons.RatingIndicator().bindProperty("value", "rating");
	oTable.addColumn(new sap.ui.table.Column({label: new sap.ui.commons.Label({text: "Rating"}), template: oControl, sortProperty: "rating", filterProperty: "rating"}));
	
	var oModel = new sap.ui.model.json.JSONModel();
	if (!oModel.getData) oModel.getData = function() { return oModel.oData; };
	oModel.setData({modelData: aData});
	oTable.setModel(oModel);
	oTable.bindRows("/modelData");
	
    qutils.delayTestStart();

	module("DataTable - Basic Rendering Test", {
		setup: function() {
	 		// setup
	 	},
	 	teardown: function() {
	 		// teardown
	 	}
	});
	
	test("RenderingOk", 7, function() {
		
		oTable.placeAt("target1");
		sap.ui.getCore().applyChanges();
		
		stop();
		setTimeout(function() {

			start();

			equal(1, oTable.$().length, "Table DIV DOM element available!");
 			equal(1, oTable.$().find(".sapUiTableHdr").length, "Table Header DOM element available!");
			equal(1, oTable.$().find(".sapUiTableTbr").length, "Table Toolbar DOM element available!");
			equal(0, oTable.$().find(".sapUiTableFtr").length, "Table Footer DOM element available!");

			equal(1, oTable.$().find(".sapUiTableCtrl").length, "Table DOM element available!");
			equal(8, oTable.$().find(".sapUiTableCtrlCol > th").length, "Table Column DOM elements available!");
			equal(10, oTable.$().find(".sapUiTableCtrl > tbody > tr").length, "Table Body DOM element available!");
		
		}, (sap.ui.Device.browser.safari ? 2500 : 500));
		
	});
    
	test("TitleOk", 2, function() {
		
		equal(oTable.getTitle().getText(), "DataTable", "Title of Table is correct!");
		equal(1, jQuery.sap.byId(oTable.getTitle().getId()).length, "Title of Table is available!");
		
	});
    
	test("ToolbarOk", 2, function() {
		
		equal(1, oTable.getToolbar().getItems().length, "Toolbar of Table is correct!");
		equal(1, jQuery.sap.byId(oTable.getToolbar().getId()).length, "Toolbar of Table is available!");
		
	});
    
	test("SelectionModeOk", 8, function() {
		
		oTable.setSelectionMode("Single");
		sap.ui.getCore().applyChanges();
		equal(true, oTable.$().find(".sapUiTableColRowHdr").is(":visible"), "Row Selection Header is visible!");
		equal(true, oTable.$().find(".sapUiTableRowHdr").is(":visible"), "Row Selectors are visible!");
		equal(0, jQuery.sap.byId(oTable.getId() + "-selall").find(".sapUiTableColRowHdrIco").length, "Select All Handle is hidden!");

		oTable.setSelectionMode("Multi");
		sap.ui.getCore().applyChanges();
		equal(true, oTable.$().find(".sapUiTableColRowHdr").is(":visible"), "Row Selection Header is visible!");
		equal(true, oTable.$().find(".sapUiTableRowHdr").is(":visible"), "Row Selectors are visible!");
		equal(1, jQuery.sap.byId(oTable.getId() + "-selall").find(".sapUiTableColRowHdrIco").length, "Select All Handle is visible!");

		oTable.setSelectionMode("None");
		sap.ui.getCore().applyChanges();
		equal(false, oTable.$().find(".sapUiTableColRowHdr").is(":visible"), "Row Selection Header is hidden!");
		equal(false, oTable.$().find(".sapUiTableRowHdr").is(":visible"), "Row Selectors are hidden!");
		
	});
    
	test("VisibleRowCountOk", 3, function() {
		
		oTable.setVisibleRowCount(5);
		sap.ui.getCore().applyChanges();
		equal(5, oTable.$().find(".sapUiTableCtrl > tbody > tr").length, "Visible Row Count is correct!");
		
		oTable.setVisibleRowCount(20);
		sap.ui.getCore().applyChanges();
		equal(20, oTable.$().find(".sapUiTableCtrl > tbody > tr").length, "Visible Row Count is correct!");
		
		oTable.setVisibleRowCount(30);
		sap.ui.getCore().applyChanges();
		equal(30, oTable.$().find(".sapUiTableCtrl > tbody > tr").length, "Visible Row Count is correct!");
		
	});
    
	asyncTest("VerticalScrollbarOk", 2, function() {

		oTable.setVisibleRowCount(20);
		sap.ui.getCore().applyChanges();
		setTimeout(function() {

			start();

			equal(0, oTable.$().find(".sapUiTableVSb:visible").length, "Table Scrollbar is hidden!");

			oTable.setVisibleRowCount(10);
			sap.ui.getCore().applyChanges();
			equal(1, oTable.$().find(".sapUiTableVSb:visible").length, "Table Scrollbar is visible!");
			
		}, 10);

	});
	
	test("ExpandingOk", 3, function() {
		
		oTable.setExpanded(true);
		sap.ui.getCore().applyChanges();
		equal(20, oTable.$().find(".sapUiTableCtrl > tbody > tr").length, "Expanded Visible Row Count is correct!");
		
		oTable.setExpandedVisibleRowCount(30);
		sap.ui.getCore().applyChanges();
		equal(30, oTable.$().find(".sapUiTableCtrl > tbody > tr").length, "Expanded Visible Row Count is correct!");
		
		oTable.setExpanded(false);
		sap.ui.getCore().applyChanges();
		equal(10, oTable.$().find(".sapUiTableCtrl > tbody > tr").length, "Expanded Visible Row Count is correct!");
		
	});
    
	test("FirstVisibleRowOk", 1, function() {
		
		oTable.setFirstVisibleRow(5);
		sap.ui.getCore().applyChanges();
		equal(5, oTable.getFirstVisibleRow(), "First Visible Row correct!");
		
		/*
		oTable.setFirstVisibleRow(15);
		sap.ui.getCore().applyChanges();
		equal(10, oTable.getFirstVisibleRow(), "First Visible Row correct!");
		*/
		
	});
	
    </script>
  </head>
  <body class="sapUiBody">
    <h1 id="qunit-header">qUnit Page for sap.ui.table.DataTable</h1>
    <h2 id="qunit-banner"></h2>
    <h2 id="qunit-userAgent"></h2>
    <ol id="qunit-tests"></ol>
    <div id="qunit-fixture">test markup, will be hidden</div>
    <div id="target1"></div>  
  </body>
</html>
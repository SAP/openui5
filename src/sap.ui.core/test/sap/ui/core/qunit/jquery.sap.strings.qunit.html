<!DOCTYPE HTML>

<!-- 
  Tested control/class: jquery.sap.strings.js
  Author: d050084
-->

<html>
  
<head>
<META http-equiv="Content-Type" content="text/html; charset=utf-8">
    
<title>Test Page for jquery.sap.strings.js</title>
    
	<script id="sap-ui-bootstrap"
		      type="text/javascript"
		      src="../../../../../resources/sap-ui-core.js"
		      data-sap-ui-theme="sap_bluecrystal"
		      data-sap-ui-noConflict="true"> 
	</script>
		<link rel="stylesheet" href="../../../../../resources/sap/ui/thirdparty/qunit.css" type="text/css" media="screen" />
		<script type="text/javascript" src="../../../../../resources/sap/ui/thirdparty/qunit.js"></script>
		<script type="text/javascript" src="../../../../../resources/sap/ui/qunit/qunit-junit.js"></script>
		<script type="text/javascript" src="../../../../../resources/sap/ui/qunit/QUnitUtils.js"></script>
		<script type="text/javascript">
		
    jQuery.sap.require("jquery.sap.strings");
		
	  test("EndsWithOk", function () {
			ok(jQuery.sap.endsWith("abcde", "cde"), "'abcde' ends with 'cde'");
			ok(jQuery.sap.endsWith("abc de", "c de"), "'abc de' ends with 'c de'");
			ok(!(jQuery.sap.endsWith("abcde", "ce")), "'abcde' doesn't end with 'ce'");
			ok(!(jQuery.sap.endsWith("abcde", "cDe")), "'abcde' doesn't end with 'cDe'");
			
			ok(!(jQuery.sap.endsWith("abcde", "")), "'abcde' doesn't end with ''");
			ok(!(jQuery.sap.endsWith("abcde", 10)), "'abcde' doesn't end with '10'");
			ok(!(jQuery.sap.endsWith("abcde", null)), "'abcde' doesn't end with null");
		});

		test("EndsWithFailed", function () {
			try {
				jQuery.sap.endsWith(null, "abc");
				ok(false, "exception should have been thrown");
			} catch (e) {
		  		ok(true, "exception expected");
			}
		});

		  test("EndsWithIgnoreCaseOk", function () {
				ok(jQuery.sap.endsWithIgnoreCase("abcdE", "cDe"), "'abcdE' ends with 'cDe'");
				ok(jQuery.sap.endsWithIgnoreCase("abcdE", "cDe"), "'abcdE' does end with 'cDe'");
				ok(jQuery.sap.endsWith("abc De", "c De"), "'abc De' ends with 'c De'");
				ok(!(jQuery.sap.endsWithIgnoreCase("abcdE", "cE")), "'abcdE' doesn't end with 'cE'");
				
				ok(!(jQuery.sap.endsWithIgnoreCase("abcdE", "")), "'abcdE' doesn't end with ''");
				ok(!(jQuery.sap.endsWithIgnoreCase("abcdE", 10)), "'abcdE' doesn't end with '10'");
				ok(!(jQuery.sap.endsWithIgnoreCase("abcdE", null)), "'abcdE' doesn't end with null");
			});
			
			test("EndsWithIgnoreCaseFailed", function () {
				try {
					jQuery.sap.endsWithIgnoreCase(null, "abC");
					ok(false, "exception should have been thrown");
				} catch (e) {
			  		ok(true, "exception expected");
				}
			});

		test("StartsWithOk", function () {
			ok(jQuery.sap.startsWith("abcde", "abc"), "'abcde' starts with 'abc'");
			ok(jQuery.sap.startsWith("abCde", "abCd"), "'abCde' starts with 'abCd'");
			ok(jQuery.sap.startsWith("abc de", "abc d"), "'abc de' starts with 'abc d'");
			ok(jQuery.sap.startsWith("abc de", "abc "), "'abc de' starts with 'abc '");
			ok(!(jQuery.sap.startsWith("abcde", "ac")), "'abcde' doesn't start with 'ac'");
			ok(!(jQuery.sap.startsWith("abcde", "aB")), "'abcde' doesn't start with 'aB'");
					
			ok(!(jQuery.sap.startsWith("abcde", "")), "'abcde' doesn't start with ''");
			ok(!(jQuery.sap.startsWith("abcde", 10)), "'abcde' doesn't start with '10'");
			ok(!(jQuery.sap.startsWith("abcde", null)), "'abcde' doesn't start with null");
		});	

		test("StartsWithFailed", function () {
			try {
				jQuery.sap.startsWith(null, "abc");
				ok(false, "exception should have been thrown");
			} catch (e) {
		  		ok(true, "exception expected");
			}
		});

		test("StartsWithIgnoreCaseOk", function () {
			ok(jQuery.sap.startsWithIgnoreCase("abcde", "Abc"), "'abcde' starts with 'abc'");
			ok(jQuery.sap.startsWithIgnoreCase("abCde", "aBCd"), "'abCde' starts with 'aBCd'");
			ok(jQuery.sap.startsWithIgnoreCase("abC de", "abc D"), "'abC de' starts with 'abc D'");
			ok(jQuery.sap.startsWithIgnoreCase("abC de", "aBc "), "'abC de' starts with 'aBc '");
			ok(!(jQuery.sap.startsWithIgnoreCase("abCde", "aC")), "'abCde' doesn't start with 'aC'");
					
			ok(!(jQuery.sap.startsWithIgnoreCase("abcdE", "")), "'abcdE' doesn't start with ''");
			ok(!(jQuery.sap.startsWithIgnoreCase("abcdE", 10)), "'abcdE' doesn't start with '10'");
			ok(!(jQuery.sap.startsWithIgnoreCase("abcdE", null)), "'abcdE' doesn't start with null");
		});	

		test("StartsWithIgnoreCaseFailed", function () {
			try {
				jQuery.sap.startsWithIgnoreCase(null, "aBc");
				ok(false, "exception should have been thrown");
			} catch (e) {
		  		ok(true, "exception expected");
			}
		});		

//		test("ContainsOk", function (){
//			assertTrue("'abcde' contains 'abc'", jQuery.sap.contains("abcde", "abc"));
//			assertTrue("'abCde' contains 'bCd'", jQuery.sap.contains("abCde", "bCd"));
//			assertTrue("'abCde' contains 'Cde'", jQuery.sap.contains("abCde", "Cde"));
//			assertTrue("'abC de' contains 'C de'", jQuery.sap.contains("abC de", "C de"));
//			assertFalse("'abCde' doesn't contain 'BC'", jQuery.sap.contains("abCde", "BC"));
//			assertFalse("'abCde' doesn't contain 'aC'", jQuery.sap.contains("abCde", "aC"));

//			assertFalse("'abcdE' doesn't contain ''", jQuery.sap.contains("abcdE", ""));
//			assertFalse("'abcdE' doesn't contain '10'", jQuery.sap.contains("abcdE", 10));
//			assertFalse("'abcdE' doesn't contain null", jQuery.sap.contains("abcdE", null));
//		});

//		test("ContainsFailed", function () {
//			try {
//				jQuery.sap.contains(null, "aBc");
//				assertTrue("exception should have been thrown", false);
//			} catch (e) {
//		  		assertTrue("exception expected", true);
//			}
//		});			

//		test("ContainsIgnoreCaseOk", function (){
//			assertTrue("'abcde' contains 'aBc'", jQuery.sap.containsIgnoreCase("abcde", "aBc"));
//			assertTrue("'abCde' contains 'bCD'", jQuery.sap.containsIgnoreCase("abCde", "bCD"));
//			assertTrue("'abCde' contains 'CdE'", jQuery.sap.containsIgnoreCase("abCde", "CdE"));
//			assertTrue("'abC de' contains 'Cd e'", jQuery.sap.containsIgnoreCase("abC de", "C DE"));
//			assertFalse("'abCde' doesn't contain 'Bd'", jQuery.sap.containsIgnoreCase("abCde", "Bd"));
//			assertFalse("'abCde' doesn't contain 'ac'", jQuery.sap.containsIgnoreCase("abCde", "ac"));

//			assertFalse("'abcdE' doesn't contain ''", jQuery.sap.containsIgnoreCase("abcdE", ""));
//			assertFalse("'abcdE' doesn't contain '10'", jQuery.sap.containsIgnoreCase("abcdE", 10));
//			assertFalse("'abcdE' doesn't contain null", jQuery.sap.containsIgnoreCase("abcdE", null));
//		});

//		test("ContainsIgnoreFailed", function () {
//			try {
//				jQuery.sap.containsIgnoreCase(null, "aBc");
//				assertTrue("exception should have been thrown", false);
//			} catch (e) {
//		  		assertTrue("exception expected", true);
//			}
//		});

//		test("IsEmpty", function (){
//			assertTrue(jQuery.sap.isEmpty(""));
//			assertTrue(jQuery.sap.isEmpty("    "));
//			assertFalse(jQuery.sap.isEmpty("   .  "));
//			assertFalse(jQuery.sap.isEmpty(null));
//			assertFalse(jQuery.sap.isEmpty(10));
//		});

		test("CharToUpperCase", function (){
			strictEqual("GggT", jQuery.sap.charToUpperCase("gggT"));
			strictEqual("Gs4T", jQuery.sap.charToUpperCase("gs4T"));
			strictEqual("GggT", jQuery.sap.charToUpperCase("gggT",0));
			strictEqual("gggT", jQuery.sap.charToUpperCase("gggT",3));
			strictEqual("ggGT", jQuery.sap.charToUpperCase("gggT",2));
			strictEqual("loW", jQuery.sap.charToUpperCase("low",2));
			strictEqual("Löw", jQuery.sap.charToUpperCase("löw",3));
			
			strictEqual("GggT", jQuery.sap.charToUpperCase("gggT",-1));
			strictEqual("GggT", jQuery.sap.charToUpperCase("gggT",-2));
			strictEqual("GggT", jQuery.sap.charToUpperCase("gggT","kgtzjrf"));
			strictEqual("GshfJsrhT", jQuery.sap.charToUpperCase("gshfJsrhT",10));

			strictEqual("GggT", jQuery.sap.charToUpperCase("gggT",null));
			strictEqual(jQuery.sap.charToUpperCase(null,-1), null);

			try {
				jQuery.sap.charToUpperCase("gggT",k) 
				ok(false, "exception should have been thrown");
			} catch (e) {
		  		ok(true, "exception expected");
			}
			
		});
		
		
		test("CamelCase", 2, function() {
			var sCamelCase = jQuery.sap.camelCase("this-is-an-camel-case-string");
			equal(sCamelCase, "thisIsAnCamelCaseString", "CamelCase function returns the right value");
			
			var sCamelCase = jQuery.sap.camelCase("this-is-an-1amel-case-ütring");
			equal(sCamelCase, "thisIsAn1amelCaseÜtring", "CamelCase function returns the right value for numeric and umlauts chars");
		});

		module("formatMessage");
		
		test("simple case", function() {
			equal(jQuery.sap.formatMessage("Say {0}", ["Hello"]), "Say Hello", "should replace unqouted placeholder0");
			equal(jQuery.sap.formatMessage("{2},{1},{0}, {3}!", ["1", "2", "3", "Go"]), "3,2,1, Go!", "should replace multiple placeholders in the right order");
			equal(jQuery.sap.formatMessage("{0},{2},{0}, {2}!", ["1", "2", "3", "Go"]), "1,3,1, 3!", "should replace multiple occurences of the same placeholders with the same value");
		});

		test("escaping", function() {
			equal(jQuery.sap.formatMessage("Say '{0}'", ["Hello"]), "Say {0}", "quoted placeholder should be ignored");
			equal(jQuery.sap.formatMessage("Say ''{0}''", ["Hello"]), "Say 'Hello'", "double single quotes are added to the result as single quotes, even around placeholders");
			equal(jQuery.sap.formatMessage("'Some JS Object {x:''text''}': {0}", ["Hello"]), "Some JS Object {x:'text'}: Hello", "quoted fragment should be copied 1:1, with double sinqle quotes replaced by single single quotes");
			equal(jQuery.sap.formatMessage("Say '{0}", ["Hello"]), "Say {0}", "missing final quote should be added silently");
		});

		test("format types", function() {
			equal(jQuery.sap.formatMessage("Say {0,integer}", [12.4]), "Say 12.4", "format type should be silently ignored");
			equal(jQuery.sap.formatMessage("Say {0,some+-'}", ["Hello"]), "Say Hello", "syntactically incorrect specifiers should be ignored as long as they contain no nested placeholders");
		});

		test("formatter case", function() {
			equal(jQuery.sap.formatMessage("Say {0} 12", 0), "Say 0 12", "should replace unqouted placeholder0");
			equal(jQuery.sap.formatMessage("Say {0}", "Hello"), "Say Hello", "should replace unqouted placeholder0");
			equal(jQuery.sap.formatMessage("Say {0} {1}", "Hello",12), "Say Hello 12", "should replace unqouted placeholder 0 and 1");
			equal(jQuery.sap.formatMessage("Say {0,integer}", 12.4), "Say 12.4", "format type should be silently ignored");
			equal(jQuery.sap.formatMessage("Say '{0}'", "Hello"), "Say {0}", "quoted placeholder should be ignored");
		});

		test("pattern syntax errors", 5, function() {
			try {
				jQuery.sap.formatMessage("Say }", [12.4]);
			} catch (e) {
				ok(true, "unbalanced curly braces should raise an error");
			}
			try {
				jQuery.sap.formatMessage("Say {0} or {", [12.4]);
			} catch (e) {
				ok(true, "unbalanced curly braces should raise an error");
			}
			try {
				jQuery.sap.formatMessage("Say {x,integer}", [12.4]);
			} catch (e) {
				ok(true, "non-numerical argument index should raise an error");
			}
			try {
				jQuery.sap.formatMessage("Say {0integer}", [12.4]);
			} catch (e) {
				ok(true, "not properly separated format options raise an error");
			}
			try {
				jQuery.sap.formatMessage("There {0,choice,0#are no files|1#is one file|1<are {0,number,integer} files}.", [5]);
			} catch (e) {
				ok(true, "nested placeholders raise an error");
			}
		});

     </script>
  </head>
	<body>
		<h1 id="qunit-header">QUnit page for jquery.sap.properties</h1>
		<h2 id="qunit-banner"></h2>
	 	<h2 id="qunit-userAgent"></h2>
		<div id="qunit-testrunner-toolbar"></div>
		<ol id="qunit-tests"></ol>
	</body>
</html>

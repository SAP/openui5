<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>InvisibleText - sap.ui.core</title>
		<script id="sap-ui-bootstrap"
				src="../../../../resources/sap-ui-core.js"
				data-sap-ui-libs="sap.ui.core" 
				data-sap-ui-theme="sap_bluecrystal">
		</script>
		<script>
		
		jQuery.sap.declare("sap.ui.core.TestControl");
		sap.ui.core.Control.extend("sap.ui.core.TestControl", {
			metadata: {
				library : "sap.ui.core",
				aggregations : {
					_texts: {name: "_texts", type: "sap.ui.core.InvisibleText", multiple : true, visibility: "hidden"}
				},
				associations : {
					ariaDescribedBy : {type : "sap.ui.core.Control", multiple : true, singularName : "ariaDescribedBy"}, 
					ariaLabelledBy : {type : "sap.ui.core.Control", multiple : true, singularName : "ariaLabelledBy"}
				}
			},
			
			init: function() {
				if (!sap.ui.core.TestControl._STATIC_LABEL_TEXT) {
					sap.ui.core.TestControl._STATIC_LABEL_TEXT = new sap.ui.core.InvisibleText({text: "Some static label by control"});
					sap.ui.core.TestControl._STATIC_LABEL_TEXT.toStatic(); //Put to Static UiArea
				}
				
				this.addAggregation("_texts", new sap.ui.core.InvisibleText({text: "Some dynamic label by control"}), true);
			},
			
			renderer: {
				render: function(rm, ctrl){
					rm.write("<div");
					rm.writeControlData(ctrl);
					rm.write(">");
					var sLabelled = sap.ui.core.TestControl._STATIC_LABEL_TEXT.getId();
					var aTexts = ctrl.getAggregation("_texts");
					for(var i=0; i<aTexts.length; i++){
						sLabelled += " " + aTexts[i].getId();
						rm.renderControl(aTexts[i]);
					}
					rm.write("<input");
					rm.writeAccessibilityState(ctrl, {
						labelledby : {value: sLabelled, append: true}
					})
					rm.write("></input></div>");
				}
			}
		});
		
		
		(new sap.ui.core.InvisibleText("myText", {text: "Some static label by application"})).toStatic();
		
		(new sap.ui.core.TestControl({ariaLabelledBy: "myText"})).placeAt("content");
		
		
		
		sap.ui.controller("my.own.controller", {});
		var xml = '<mvc:View xmlns:core="sap.ui.core" xmlns:mvc="sap.ui.core.mvc" xmlns="sap.ui.commons"'
			+ '              controllerName="my.own.controller" xmlns:html="http://www.w3.org/1999/xhtml">'
			+ '       <core:TestControl ariaLabelledBy="myViewText"/>'
			+ '       <core:InvisibleText id="myViewText" text="Some text"/>'
			+ '    </mvc:View>';
		var myView = sap.ui.xmlview({viewContent:xml});
		myView.placeAt('content');
		
		</script>
	</head>
	<body id="body" class="sapUiBody">
		<div id="content"></div>
	</body>
</html>
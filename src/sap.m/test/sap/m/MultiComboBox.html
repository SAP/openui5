<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta charset="UTF-8">
<title>MultiComboBox - sap.m</title>
<script id="sap-ui-bootstrap" src="../../../resources/sap-ui-core.js"
	data-sap-ui-libs="sap.m" data-sap-ui-theme="sap_bluecrystal"
	data-sap-ui-compatVersion="1.20">
	
</script>
<script>
	jQuery.sap.require("sap.m.MessageToast");
	jQuery.sap.require("jquery.sap.xml");

	var oModel = new sap.ui.model.json.JSONModel();

	var mData = {
		"selected" : ["AR", "BH"],
		"items" : [{
			"key" : "DZ",
			"text" : "Algeria"
		}, {
			"key" : "AR",
			"text" : "Argentina"
		}, {
			"key" : "AR1",
			"text" : "Argentina"
		}, {
			"key" : "AU",
			"text" : "Australia"
		}, {
			"key" : "DI",
			"text" : "Disabled",
			"enabled" : false
		}, {
			"key" : "AT",
			"text" : "Austria"
		},

		{
			"key" : "BH",
			"text" : "Bahrain"
		},

		{
			"key" : "BE",
			"text" : "Belgium"
		},

		{
			"key" : "BA",
			"text" : "Bosnia and Herzegovina"
		},

		{
			"key" : "BR",
			"text" : "Brazil"
		},

		{
			"key" : "BG",
			"text" : "Bulgaria"
		},

		{
			"key" : "CA",
			"text" : "Canada"
		},

		{
			"key" : "CL",
			"text" : "Chile"
		},

		{
			"key" : "CO",
			"text" : "Colombia"
		},

		{
			"key" : "HR",
			"text" : "Croatia"
		},

		{
			"key" : "CZ",
			"text" : "Czech Republic"
		},

		{
			"key" : "DK",
			"text" : "Denmark"
		},

		{
			"key" : "EG",
			"text" : "Egypt"
		},

		{
			"key" : "EE",
			"text" : "Estonia"
		},

		{
			"key" : "FI",
			"text" : "Finland"
		},

		{
			"key" : "FR",
			"text" : "France"
		},

		{
			"key" : "GH",
			"text" : "Ghana"
		},

		{
			"key" : "GR",
			"text" : "Greece"
		},

		{
			"key" : "HK",
			"text" : "Hong Kong"
		},

		{
			"key" : "HU",
			"text" : "Hungary"
		},

		{
			"key" : "IN",
			"text" : "India"
		},

		{
			"key" : "ID",
			"text" : "Indonesia"
		},

		{
			"key" : "IE",
			"text" : "Ireland"
		},

		{
			"key" : "IL",
			"text" : "Israel"
		},

		{
			"key" : "IT",
			"text" : "Italy"
		},

		{
			"key" : "JP",
			"text" : "Japan"
		},

		{
			"key" : "JO",
			"text" : "Jordan"
		},

		{
			"key" : "KE",
			"text" : "Kenya"
		},

		{
			"key" : "KW",
			"text" : "Kuwait"
		},

		{
			"key" : "LV",
			"text" : "Latvia"
		},

		{
			"key" : "LT",
			"text" : "Lithuania"
		},

		{
			"key" : "MK",
			"text" : "Macedonia"
		},

		{
			"key" : "MY",
			"text" : "Malaysia"
		},

		{
			"key" : "MX",
			"text" : "Mexico"
		},

		{
			"key" : "ME",
			"text" : "Montenegro"
		},

		{
			"key" : "MA",
			"text" : "Morocco"
		},

		{
			"key" : "NL",
			"text" : "Netherlands"
		},

		{
			"key" : "NZ",
			"text" : "New Zealand"
		},

		{
			"key" : "NG",
			"text" : "Nigeria"
		},

		{
			"key" : "NO",
			"text" : "Norway"
		},

		{
			"key" : "OM",
			"text" : "Oman"
		},

		{
			"key" : "PE",
			"text" : "Peru"
		},

		{
			"key" : "PH",
			"text" : "Philippines"
		},

		{
			"key" : "PL",
			"text" : "Poland"
		},

		{
			"key" : "PT",
			"text" : "Portugal"
		},

		{
			"key" : "QA",
			"text" : "Qatar"
		},

		{
			"key" : "RO",
			"text" : "Romania"
		},

		{
			"key" : "RU",
			"text" : "Russia"
		},

		{
			"key" : "SA",
			"text" : "Saudi Arabia"
		},

		{
			"key" : "SN",
			"text" : "Senegal"
		},

		{
			"key" : "RS",
			"text" : "Serbia"
		},

		{
			"key" : "SG",
			"text" : "Singapore"
		},

		{
			"key" : "SK",
			"text" : "Slovakia"
		},

		{
			"key" : "SI",
			"text" : "Slovenia"
		},

		{
			"key" : "ZA",
			"text" : "South Africa"
		},

		{
			"key" : "KR",
			"text" : "South Korea"
		},

		{
			"key" : "ES",
			"text" : "Spain"
		},

		{
			"key" : "SE",
			"text" : "Sweden"
		},

		{
			"key" : "CH",
			"text" : "Switzerland"
		},

		{
			"key" : "TW",
			"text" : "Taiwan"
		},

		{
			"key" : "TN",
			"text" : "Tunisia"
		},

		{
			"key" : "TR",
			"text" : "Turkey"
		},

		{
			"key" : "UG",
			"text" : "Uganda"
		},

		{
			"key" : "UA",
			"text" : "Ukraine"
		},

		{
			"key" : "AE",
			"text" : "United Arab Emirates"
		},

		{
			"key" : "GB",
			"text" : "United Kingdom"
		},

		{
			"key" : "YE",
			"text" : "Yemen"
		}]
	};

	oModel.setData(mData);
	sap.ui.getCore().setModel(oModel);

	var oItemTemplate = new sap.ui.core.Item({
		key : "{key}",
		text : "{text}",
		enabled : "{enabled}"
	});

	function createComboForDialog(){
		return new sap.m.MultiComboBox({
			placeholder : "Choose your country",
			items : {
				path : "/items",
				template : oItemTemplate
			},
			selectedKeys : {
				path : "/selected",
				template : "{selected}"
			},
			change : function(oControlEvent) {
				jQuery.sap.log.info('Event fired: "change" value property to ' + oControlEvent.getParameter("value") + " on "
						+ this);
			},
			selectionChange : function(oEvent) {
				jQuery.sap.log.info('Event fired: "selectionChange" value property to ' + oEvent.getParameter("changedItem")
						+ " with selected=" + oEvent.getParameter("selected") + " on " + this);
			},
			selectionFinish : function(oEvent) {
				jQuery.sap.log.info('Event fired: "selectionFinish" value property to ' + oEvent.getParameter("selectedItems")
						+ " on " + this);
			}
		});		
	}
	
	var oDialog = new sap.m.Dialog("dialog", {
		title: "Multi Inputs",
		contentWidth: "420px",
		horizontalScrolling: false,
		content: [
					createComboForDialog(),
					createComboForDialog(),
					createComboForDialog(),
					createComboForDialog(),
					createComboForDialog(),
					createComboForDialog(),
					createComboForDialog(),
					createComboForDialog(),
					createComboForDialog(),
					createComboForDialog(),
					createComboForDialog(),
					createComboForDialog(),
					createComboForDialog(),
					createComboForDialog()
				],
		beginButton: 
			new sap.m.Button({
				text: "OK",
				type: sap.m.ButtonType.Accept,
				press : function() {
					oDialog.close();
				}
			}),
		endButton:
			new sap.m.Button({
				text: "Cancel",
				type: sap.m.ButtonType.Reject,
				press : function() {
					oDialog.close();
				}
		})
	});
	// open in a dialog
	function openDialog(){
		oDialog.open();
	}

	var oComboBox = new sap.m.ComboBox({
		placeholder : "Choose your country",
		width : "400px",
		items : {
			path : "/items",
			template : oItemTemplate
		},

		change : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "change" value property to ' + oControlEvent.getParameter("value") + " on "
					+ this);
		},

		selectionChange : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "selectionChange" value property to '
					+ oControlEvent.getParameter("selectedItem") + " on " + this);
		}
	});

	//var oEventList = new sap.m.List();
	var oSearchProvider = new sap.ui.core.search.OpenSearchProvider({
		suggestUrl : "../../../proxy/http/en.wikipedia.org/w/api.php?action=opensearch&namespace=0&search={searchTerms}",
		suggestType : "json"
	});
	var oMultiInput1 = new sap.m.MultiInput({
		placeholder : "add tokens by suggestions",
		suggest : function(oEvent) {
			var that = this;
			oSearchProvider.suggest(oEvent.getParameter("suggestValue"), function(sValue, aSuggestions) {
				if (sValue === that.getValue()) {
					that.destroySuggestionItems();
					for ( var i = 0; i < aSuggestions.length; i++) {
						that.addSuggestionItem(new sap.ui.core.Item({
							text : aSuggestions[i],
							key : aSuggestions[i]
						}));
					}
				}
			});
		},
		valueHelpRequest : function(evt) {
			sap.m.MessageBox.alert("Value help requested");
		},
		width : "75%"
	});

	var oMultiComboBox = new sap.m.MultiComboBox({
		id : "MultiComboBox0",
		placeholder : "width = 50%",
		width : "50%",
		items : {
			path : "/items",
			template : oItemTemplate
		},
		change : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "change" value property to ' + oControlEvent.getParameter("value") + " on "
					+ this);
		},
		selectionChange : function(oEvent) {
			jQuery.sap.log.info('Event fired: "selectionChange" value property to ' + oEvent.getParameter("changedItem")
					+ " with selected=" + oEvent.getParameter("selected") + " on " + this);
		},
		selectionFinish : function(oEvent) {
			jQuery.sap.log.info('Event fired: "selectionFinish" value property to ' + oEvent.getParameter("selectedItems")
					+ " on " + this);
		}
	});
	var oMultiComboBox2 = new sap.m.MultiComboBox({
		id : "MultiComboBox2",
		width : "400px",
		placeholder : "Choose your country",
		items : {
			path : "/items",
			template : oItemTemplate
		},
		selectedKeys : {
			path : "/selected",
			template : "{selected}"
		},
		change : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "change" value property to ' + oControlEvent.getParameter("value") + " on "
					+ this);
		},
		selectionChange : function(oEvent) {
			jQuery.sap.log.info('Event fired: "selectionChange" value property to ' + oEvent.getParameter("changedItem")
					+ " with selected=" + oEvent.getParameter("selected") + " on " + this);
		},
		selectionFinish : function(oEvent) {
			jQuery.sap.log.info('Event fired: "selectionFinish" value property to ' + oEvent.getParameter("selectedItems")
					+ " on " + this);
		}
	});

	var oMultiComboBoxBinding = new sap.m.MultiComboBox({
		id : "MultiComboBoxBinding",
		placeholder : "binding test: navigate to next page and back",
		width : "400px",
		items : {
			path : "/items",
			template : new sap.ui.core.Item({
				key : "{key}",
				text : "{text}",
				enabled : "{enabled}"
			})
		},
		selectedKeys : {
			path : "/selected",
			template : "{selected}"
		},
		change : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "change" value property to ' + oControlEvent.getParameter("value") + " on "
					+ this);
		},
		selectionChange : function(oEvent) {
			jQuery.sap.log.info('Event fired: "selectionChange" value property to ' + oEvent.getParameter("changedItem")
					+ " with selected=" + oEvent.getParameter("selected") + " on " + this);
		},
		selectionFinish : function(oEvent) {
			jQuery.sap.log.info('Event fired: "selectionFinish" value property to ' + oEvent.getParameter("selectedItems")
					+ " on " + this);
		}
	});
	oMultiComboBoxBinding.setModel(new sap.ui.model.json.JSONModel({
		"selected" : [],
		"items" : [{
			"key" : "AL",
			"text" : "Algeria"
		}, {
			"key" : "AR",
			"text" : "Argentina"
		}, {
			"key" : "NO",
			"text" : "Norway"
		}, {
			"key" : "OM",
			"text" : "Oman"
		}]
	}));

	var oItem20, oItem21, oItem22, oItem23;
	var oMultiComboBox1 = new sap.m.MultiComboBox({
		id : "MultiComboBox1",
		width : "300px",
		placeholder : "Choose your country",
		items : [oItem20 = new sap.ui.core.Item({
			key : "0",
			text : "item 0"
		}),

		oItem21 = new sap.ui.core.Item({
			key : "1",
			text : "item 1"
		}),

		oItem22 = new sap.ui.core.Item({
			key : "2",
			text : "item 2 is a little long"
		}),

		oItem23 = new sap.ui.core.Item({
			key : "3",
			text : "item 3"
		})],
		change : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "change" value property to ' + oControlEvent.getParameter("value") + " on "
					+ this);
		},
		selectedKeys : ["0", "1", "2"],
		selectionChange : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "selectionChange" value property to '
					+ oControlEvent.getParameter("selectedItems") + " on " + this);
		}
	});

	var oMultiComboBoxError = new sap.m.MultiComboBox({
		id : "MultiComboBoxError",
		width : "300px",
		placeholder : "Error",
		valueState : "Error",
		items : [new sap.ui.core.Item({
			key : "0",
			text : "item 0"
		}), new sap.ui.core.Item({
			key : "1",
			text : "item 1"
		})],
		change : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "change" value property to ' + oControlEvent.getParameter("value") + " on "
					+ this);
		},

		selectionChange : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "selectionChange" value property to '
					+ oControlEvent.getParameter("selectedItems") + " on " + this);
		}
	});
	var oMultiComboBoxWarning = new sap.m.MultiComboBox({
		id : "MultiComboBoxWarning",
		width : "300px",
		placeholder : "Warning",
		valueState : "Warning",
		items : [new sap.ui.core.Item({
			key : "0",
			text : "item 0"
		}), new sap.ui.core.Item({
			key : "1",
			text : "item 1"
		})],
		change : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "change" value property to ' + oControlEvent.getParameter("value") + " on "
					+ this);
		},
		selectionChange : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "selectionChange" value property to '
					+ oControlEvent.getParameter("selectedItems") + " on " + this);
		}
	});
	var oMultiComboBoxSuccess = new sap.m.MultiComboBox({
		id : "MultiComboBoxSuccess",
		width : "300px",
		placeholder : "Success",
		valueState : "Success",
		items : [new sap.ui.core.Item({
			key : "0",
			text : "item 0"
		}), new sap.ui.core.Item({
			key : "1",
			text : "item 1"
		})],
		change : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "change" value property to ' + oControlEvent.getParameter("value") + " on "
					+ this);
		},
		selectionChange : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "selectionChange" value property to '
					+ oControlEvent.getParameter("selectedItems") + " on " + this);
		}
	});
	var oItem;
	var oMultiComboBoxDisabledListItemSelectable = new sap.m.MultiComboBox({
		id : "MultiComboBoxDisabledListItemSelectable",
		width : "400px",
		placeholder : "Disabled list item showing selecable feature",
		items : [oItem = new sap.ui.core.Item({
			text : "triggers last item"
		}), new sap.ui.core.Item({
			text : "item 1"
		}), new sap.ui.core.Item({
			text : "disabled item",
			enabled : false
		}), new sap.ui.core.Item({
			text : "last item"
		})],
		selectedItems : [oItem],
		change : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "change" value property to ' + oControlEvent.getParameter("value") + " on "
					+ this);
		},
		selectionChange : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "selectionChange" value property to '
					+ oControlEvent.getParameter("selectedItems") + " on " + this);
			if (this.getFirstItem() === oControlEvent.getParameter("selectedItem")) {
				this.setSelectable(this.getLastItem(), oControlEvent.getParameter("selected"));
			}
		}
	});

	var oMultiComboBoxDisabledListItemDisabled = new sap.m.MultiComboBox({
		id : "MultiComboBoxDisabledListItemDisabled",
		width : "400px",
		placeholder : "Disabled list item showing disabled item",
		items : [oItem = new sap.ui.core.Item({
			text : "triggers last item"
		}), new sap.ui.core.Item({
			text : "item 1"
		}), new sap.ui.core.Item({
			text : "disabled item",
			enabled : false
		}), new sap.ui.core.Item({
			text : "last item"
		})],
		selectedItems : [oItem],
		change : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "change" value property to ' + oControlEvent.getParameter("value") + " on "
					+ this);
		},
		selectionChange : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "selectionChange" value property to '
					+ oControlEvent.getParameter("selectedItems") + " on " + this);
			if (this.getFirstItem() === oControlEvent.getParameter("selectedItem")) {
				this.getLastItem().setEnabled(oControlEvent.getParameter("selected"));
			}
		}
	});

	var items = [new sap.ui.core.Item({
		text : "Algeria"
	}), new sap.ui.core.Item({
		text : "Bulgaria"
	}), new sap.ui.core.Item({
		text : "Canada"
	}), new sap.ui.core.Item({
		text : "Denmark"
	}), new sap.ui.core.Item({
		text : "Estonia"
	})];
	var oMultiComboBoxReadOnly = new sap.m.MultiComboBox({
		id : "MultiComboBoxReadOnly",
		width : "300px",
		placeholder : "ReadOnlyListItem",
		items : items,
		selectedItems : [items[0], items[1], items[2], items[3], items[4]],
		editable : false,
		change : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "change" value property to ' + oControlEvent.getParameter("value") + " on "
					+ this);
		},
		selectionChange : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "selectionChange" value property to '
					+ oControlEvent.getParameter("selectedItems") + " on " + this);
		}
	});
	oMultiComboBoxReadOnly.setValue("Eston");

	var oMultiComboBoxDisabled = new sap.m.MultiComboBox({
		id : "MultiComboBoxDisabled",
		width : "300px",
		placeholder : "Disabled",
		items : [new sap.ui.core.Item({
			text : "Algeria",
			key : "AL"
		}), new sap.ui.core.Item({
			text : "Bulgaria",
			key : "BU"
		}), new sap.ui.core.Item({
			text : "Canada",
			key : "CA"
		})],
		selectedKeys : ["AL", "BU", "CA"],
		enabled : false,
		change : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "change" value property to ' + oControlEvent.getParameter("value") + " on "
					+ this);
		},
		selectionChange : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "selectionChange" value property to '
					+ oControlEvent.getParameter("selectedItems") + " on " + this);
		}
	});
	oMultiComboBoxDisabled.setValue("Eston");

	var oMultiComboBoxWithoutKey = new sap.m.MultiComboBox({
		id : "MultiComboBoxWithoutKey",
		width : "300px",
		placeholder : "WithoutKeyListItem",
		items : [new sap.ui.core.Item({
			text : "item 0"
		}), new sap.ui.core.Item({
			text : "item 1"
		})],
		change : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "change" value property to ' + oControlEvent.getParameter("value") + " on "
					+ this);
		},
		selectionChange : function(oControlEvent) {
			jQuery.sap.log.info('Event fired: "selectionChange" value property to '
					+ oControlEvent.getParameter("selectedItems") + " on " + this);
		}
	});
	var theCompactMode = new sap.m.CheckBox({
		selected : true,
		select : function() {
			$("body").toggleClass("sapUiSizeCompact");
		}
	});
	var oToolbar = new sap.m.Toolbar({
		active : false,
		design : sap.m.ToolbarDesign.Solid,
		tooltip : "This is a Toolbar",
		content : [
				new sap.m.MultiComboBox({
					id : "MultiComboBoxToolbar",
					width : "300px",
					items : [new sap.ui.core.Item({
						text : "item 0"
					}), new sap.ui.core.Item({
						text : "item 1"
					})],
					change : function(oControlEvent) {
						jQuery.sap.log.info('Event fired: "change" value property to ' + oControlEvent.getParameter("value")
								+ " on " + this);
					},
					selectionChange : function(oControlEvent) {
						jQuery.sap.log.info('Event fired: "selectionChange" value property to '
								+ oControlEvent.getParameter("selectedItems") + " on " + this);
					}
				}), 
				new sap.m.ToolbarSpacer(),
				new sap.m.Button({text: "Open Popup", press: openDialog})
				]
	});

	var oApp = new sap.m.App("myApp", {
		initialPage : "page1"
	});
	oApp.addPage(new sap.m.Page("page1", {
		content : [oMultiComboBox2, oComboBox, oMultiInput1, oMultiComboBox, oMultiComboBox1,
				oMultiComboBoxDisabledListItemSelectable, oMultiComboBoxDisabledListItemDisabled, oMultiComboBoxReadOnly,
				oMultiComboBoxDisabled, oMultiComboBoxWithoutKey, theCompactMode, oMultiComboBoxError, oMultiComboBoxWarning,
				oMultiComboBoxSuccess, oMultiComboBoxBinding, oToolbar],
		showNavButton : true,
		navButtonPress : function() {
			oApp.to("page2")
		}
	}));

	oApp.addPage(new sap.m.Page("page2", {
		title : "Navigation",
		content : [new sap.m.Label({
			text : "Navigating back the JSON model of 'oMultiComboBoxBinding' will be replaced by new one where only 'Argentina' is selected...",
			width : "100%"
		})],
		showNavButton : true,
		navButtonPress : function() {
			oMultiComboBox2.rerender();
			var oModelNew = new sap.ui.model.json.JSONModel({
				"selected" : ["AR"],
				"items" : [{
					"key" : "AL",
					"text" : "Algeria"
				}, {
					"key" : "AR",
					"text" : "Argentina"
				}, {
					"key" : "NO",
					"text" : "Norway"
				}, {
					"key" : "OM",
					"text" : "Oman"
				}]
			});
			oMultiComboBoxBinding.setModel(oModelNew);
			sap.ui.getCore().applyChanges();
			oApp.back();
		}
	}));
	var shell = new sap.m.Shell();
	shell.setApp(oApp);
	shell.placeAt("body");
</script>
</head>
<body id="body" class="sapUiBody"></body>
</html>


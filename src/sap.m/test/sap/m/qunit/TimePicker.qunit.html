<!DOCTYPE HTML>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta charset="UTF-8" >
	<title>Test Page for sap.m.TimePicker</title>
	<script id="sap-ui-bootstrap"
			data-sap-ui-theme="sap_bluecrystal"
			data-sap-ui-noConflict="true"
			data-sap-ui-language="en-US"
			data-sap-ui-libs="sap.m" src="../../../../resources/sap-ui-core.js">
	</script>

	<link rel="stylesheet" href="../../../../resources/sap/ui/thirdparty/qunit.css" type="text/css" media="screen">
	<script type="text/javascript" src="../../../../resources/sap/ui/thirdparty/qunit.js"></script>
	<script type="text/javascript" src="../../../../resources/sap/ui/qunit/qunit-junit.js"></script>
	<script type="text/javascript" src="../../../../resources/sap/ui/qunit/qunit-coverage.js"></script>

	<script type="text/javascript" src="../../../../resources/sap/ui/qunit/QUnitUtils.js"></script>
	<script src="../../../../resources/sap/ui/thirdparty/sinon.js"></script>
	<script src="../../../../resources/sap/ui/thirdparty/sinon-ie.js"></script>
	<script src="../../../../resources/sap/ui/thirdparty/sinon-qunit.js"></script>

	<script type="text/javascript">
		sinon.config.useFakeTimers = true;
	</script>

	<script>
		jQuery.sap.require("sap.ui.core.format.DateFormat");
		jQuery.sap.require("sap.m.TimePickerSliders");
		jQuery.sap.require("sap.m.TimePickerSlider");
		jQuery.sap.require("sap.m.VisibleItem");

		module("step precision in time picker", {
			beforeEach: function() {
				this.oTp = new sap.m.TimePicker();
				this.oTp.placeAt("qunit-fixture");
				sap.ui.getCore().applyChanges();
			},
			afterEach: function() {
				this.oTp.destroy();
				this.oTp = null;
			}
		});

		test("sliders initial minutesStep value", function() {
			var STEP = 17;
			this.oTp.setMinutesStep(STEP);

			//Assert
			ok(!this.oTp._getSliders(), "no picker -> no sliders");

			//Act
			this.oTp._createPicker(this.oTp.getDisplayFormat());

			//Assert
			equal(this.oTp._getSliders().getMinutesStep(), STEP, "initial value of the time picker for minutesStep is used");
		});

		test("setMinutesStep", function() {
			var oSpySetProperty,
					oSpySlidersSetMinutesStep,
					STEP = 23;
			//arrange
			this.oTp._createPicker(this.oTp.getDisplayFormat());

			oSpySetProperty = this.spy(this.oTp, "setProperty");
			oSpySlidersSetMinutesStep = this.spy(this.oTp._getSliders(), "setMinutesStep");

			//Act
			this.oTp.setMinutesStep(STEP);

			//Assert
			ok(oSpySlidersSetMinutesStep.calledWith(STEP), "setMinutesStep is propagated to the picker part");
			ok(oSpySetProperty.calledWith("minutesStep", STEP, true), "property is updated without re-rendering");
		});

		module("step precision in sliders", {
			beforeEach: function() {
				this.oSliders = new sap.m.TimePickerSliders({
					format: "hh mm ss",
					labelText: "label",
					minutesStep: this.STEP
				});
				this.oSliders.placeAt("qunit-fixture");
				sap.ui.getCore().applyChanges();
			},
			afterEach: function() {
				this.oSliders.destroy();
				this.oSliders = null;
			},
			STEP: 5,
			ANOTHER_STEP: 14
		});

		test("setMinutesStep", function() {
			var oSpySetProperty = this.spy(this.oSliders, "setProperty"),
				oSpySetupLists = this.spy(this.oSliders, "_setupLists");

			//Act
			this.oSliders.setMinutesStep(this.ANOTHER_STEP);

			//Assert
			ok(oSpySetProperty.calledWith("minutesStep", this.ANOTHER_STEP, true), "property updated without re-rendering");
			ok(oSpySetupLists.calledOnce, "sliders are re-build");
		});

		module("step precision in a single slider", {
			beforeEach: function() {
				this.oSlider = new sap.m.TimePickerSlider({
					items: [
						sap.m.TimePickerSliders.prototype._generatePickerListValues(0, 59, this.STEP, true)
					]
				});
				this.oSlider.placeAt("qunit-fixture");
				sap.ui.getCore().applyChanges();
			},
			afterEach: function() {
				this.oSlider.destroy();
				this.oSlider = null;
			},
			STEP: 11,
			ANOTHER_STEP: 14
		});

		test("_updateStepAndValue", function() {
			var $ValuesContainer = this.oSlider.$().find(".sapMTimePickerSlider"),
				SELECTED_VALUE = 18,
				STEP = this.ANOTHER_STEP,
				fnHasValueMultipleOfStepOrEqualToSelectedValue = function(oItem) {
					var iItemValue = parseInt(oItem.getText());
					return iItemValue === SELECTED_VALUE
							|| iItemValue % STEP === 0;
				};

			//Act
			this.oSlider._updateStepAndValue(SELECTED_VALUE, STEP);

			//Assert
			ok($ValuesContainer.hasClass("SliderValues6"), "values container has the right class");
			ok(this.oSlider._getVisibleItems().every(fnHasValueMultipleOfStepOrEqualToSelectedValue), "all visible items have correct values");
			equal(this.oSlider.getSelectedValue(), SELECTED_VALUE, "slider has the right selected value");
		});

		test("margins are updated on expand", function() {
			var oSpyUpdateMargins = this.spy(this.oSlider, "_updateMargins");

			//Act
			this.oSlider.setIsExpanded(true, true);

			//Assert
			ok(oSpyUpdateMargins.calledOnce, "margins are updated on expand");

			//Act
			this.oSlider.setIsExpanded(false, true);

			//Assert
			ok(oSpyUpdateMargins.calledTwice, "margins are updated on collapse");
		});

		test("setIsCyclic", function() {
			this.oSlider.setIsCyclic(true);

			ok(!this.oSlider.$().hasClass("sapMTimePickerSliderShort"), "slider styled correctly");
			equal(this.oSlider.getProperty("isCyclic"), true, "property is updated");

			this.oSlider.setIsCyclic(false);

			ok(this.oSlider.$().hasClass("sapMTimePickerSliderShort"), "slider styled correctly");
			equal(this.oSlider.getProperty("isCyclic"), false, "property is updated")
		});

		module("slider select value by typing", {
			beforeEach: function() {
				//SUT
				this.oSlider = new sap.m.TimePickerSlider({
					items: [
						new sap.m.VisibleItem({key: "1", text: "01"}),
						new sap.m.VisibleItem({key: "2", text: "02"}),
						new sap.m.VisibleItem({key: "3", text: "03"}),
						new sap.m.VisibleItem({key: "11", text: "11"}),
						new sap.m.VisibleItem({key: "113", text: "113"})
					]
				});
				this.oSpy = sinon.spy(this.oSlider, "setSelectedValue");
				this.iNowTimeStamp = 50501234;
			},
			afterEach: function() {
				this.oSpy.restore();
				this.oSlider.destroy();
				this.oSlider = null;
			}
		});

		test("_fnHandleTypeValues immediately sets the selected value when a unique key is matched", function() {
			//Act
			this.oSlider._fnHandleTypeValues(this.iNowTimeStamp, jQuery.sap.KeyCodes.DIGIT_2);

			//Assert
			ok(this.oSpy.calledOnce, "setSelectedValue is called once");
			ok(this.oSpy.calledWith("2"), "setSelectedValue is called with the right item key");
		});

		test("_fnHandleTypeValues stacks calls that do not have exact match within a second", function() {
			//Act
			this.oSlider._fnHandleTypeValues(this.iNowTimeStamp, jQuery.sap.KeyCodes.DIGIT_1);
			this.oSlider._fnHandleTypeValues(this.iNowTimeStamp + 500, jQuery.sap.KeyCodes.DIGIT_1);

			//Assert
			equal(this.oSpy.callCount, 0, "setSelectedValue is not called yet, because there are 2 matched keys");

			//Wait
			this.clock.tick(1000);

			//Assert
			ok(this.oSpy.calledOnce, "setSelectedValue is called only once after 1 second when there are multiple matched keys");
			ok(this.oSpy.calledWith("11"), "setSelectedValue is called with the right item key");
		});

		test("_fnHandleTypeValues does not change selection when there is no matched item key", function() {
			//Act
			this.oSlider._fnHandleTypeValues(this.iNowTimeStamp, jQuery.sap.KeyCodes.DIGIT_5);

			//Assert
			equal(this.oSpy.callCount, 0, "setSelectedValue is not called after typing non-existent item key");

			//Wait
			this.clock.tick(1000);

			//Assert
			equal(this.oSpy.callCount, 0, "setSelectedValue is still not called after waiting 1 second");
		});

		module("API", {
			setup : function() {
				this.oTimePicker = new sap.m.TimePicker("t1");
				this.oTimePicker.placeAt("qunit-fixture");
				sap.ui.getCore().applyChanges();
			},
			teardown : function() {
				this.oTimePicker.destroy();
			}
		});

		test("DOM", function() {
			strictEqual(this.oTimePicker.$().length, 1, "the control is in the DOM");
		});

		test("After creating a timePicker, the picker aggregation is empty until the picker is opened", function () {
			ok(!this.oTimePicker._getPicker(), "the picker aggregation is empty before opening the picker");
		});

		test("After creating a timePicker, the picker aggregation holds a responsivePopover instance", function() {
			this.oTimePicker._openPicker();
			ok(this.oTimePicker._getPicker(), "the picker aggregation is not empty");
			strictEqual(this.oTimePicker._getPicker().getMetadata().getName(), "sap.m.ResponsivePopover", "the picker aggregation holds an instance of responsivePopover");
		});

		test("After creating new timePicker, the format property is initialized with its default value", function() {
			strictEqual(this.oTimePicker.getDisplayFormat(), "h:mm:ss a", "the default value is h:mm:ss a");
		});

		test("After changing the displayFormat property, the getDisplayFormat function returns the new value", function() {
			var newFormat = "hh:mm:ss";
			this.oTimePicker.setDisplayFormat(newFormat);
			strictEqual(this.oTimePicker.getDisplayFormat(), newFormat, "the format property was changed");
		});

		test("The method generatePickerListValues generates the correct result", function() {
			var iStart = 2;
			var iEnd = 5;
			var aList = sap.m.TimePickerSliders.prototype._generatePickerListValues(iStart, iEnd, 1, false);
			strictEqual(jQuery.isArray(aList), true, "the method returns an array");
			strictEqual(aList.length, iEnd - iStart + 1, "the method returns an array with the correct number of objects");
			strictEqual(parseInt(aList[0].getKey()), iStart, "the key property of the first element of the array is correct");
			strictEqual(parseInt(aList[0].getText()), iStart, "the text property of the first element of the array is correct");
			strictEqual(parseInt(aList[aList.length-1].getKey()), iEnd, "the key property of the last element of the array is correct");
			strictEqual(parseInt(aList[aList.length-1].getText()), iEnd, "the text property of the last element of the array is correct");
		});

		test("Value help CSS class is applied only when both properties 'Enabled' and 'Editable' are true", function () {
			//assert
			ok(this.oTimePicker.$().hasClass("sapMInputVH"), "Value help CSS class is applied by default ('Enabled' = true 'Editable' = true)");
			//arrange
			this.oTimePicker.setEnabled(false);
			this.clock.tick(1000);
			//assert
			ok(!this.oTimePicker.$().hasClass("sapMInputVH"), "Value help CSS class is NOT applied by default ('Enabled' = false 'Editable' = true)");
			//arrange
			this.oTimePicker.setEnabled(true);
			this.oTimePicker.setEditable(false);
			this.clock.tick(1000);
			//assert
			ok(!this.oTimePicker.$().hasClass("sapMInputVH"), "Value help CSS class is NOT applied by default ('Enabled' = true 'Editable' = false)");
			//arrange
			this.oTimePicker.setEnabled(false);
			this.oTimePicker.setEditable(false);
			this.clock.tick(1000);
			ok(!this.oTimePicker.$().hasClass("sapMInputVH"), "Value help CSS class is NOT applied by default ('Enabled' = true 'Editable' = false)");
		});

		module("Input formats, display formats and values", {
			beforeEach: function() {
				this._defaultFormatter = sap.ui.core.format.DateFormat.getTimeInstance({style: "medium", strictParsing: true, relative: false});
			}
		});

		//helpers
		var caseIndex = 0;
		function getID() {
			return "case" + (++caseIndex).toString();
		}

		function getDate(hours, minutes, seconds) {
			return new Date("2000", "1", "1", hours, minutes, seconds);
		}

		//test the final result after setting some properties in order
		function generateValuesTest(aSetValues, oExpectedValues) {
			//system under test
			var tp = new sap.m.TimePicker(),
				i,
				key;

			//arrange
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//act
			for (i = 0; i < aSetValues.length; i++) {
				tp[aSetValues[i]["key"]](aSetValues[i]["value"]);
			}

			//assert
			// trim because the framework formatter has no leading space,
			// but the tp now has a leading space for for h:mm, H:mm format
			equals(jQuery("#" + tp.getId() + "-inner").val().trim(), oExpectedValues["expInputVal"], "$input.val() ok");

			equals(tp.getValue(), oExpectedValues["expValue"], "getValue() ok");

			var oDateValue = tp.getDateValue();
			oDateValue.setFullYear(oExpectedValues["expDateValue"].getFullYear());
			oDateValue.setMonth(oExpectedValues["expDateValue"].getMonth());
			oDateValue.setDate(oExpectedValues["expDateValue"].getDate());
			equals(oDateValue.toString(), oExpectedValues["expDateValue"].toString(), "getDateValue ok");

			//cleanup
			tp.destroy();
		}

		test(getID(), function() {
			var that = this;
			generateValuesTest([
						{ key: "setValue", value: "13:34:00" },
						{ key: "setValueFormat", value: "HH:mm:ss" }
					],
					{
						expInputVal: that._defaultFormatter.format(getDate(13, 34, 0)),
						expValue: "13:34:00",
						expDateValue: getDate(13, 34, 0)
					});
		});

		test(getID(), function() {
			var that = this;
			generateValuesTest([
						{ key: "setValueFormat", value: "HH:mm:ss" },
						{ key: "setValue", value: "21:13:14" }
					],
					{
						expInputVal: that._defaultFormatter.format(getDate(21, 13, 14)),
						expValue: "21:13:14",
						expDateValue: getDate(21, 13, 14)
					});
		});

		test(getID(), function() {
			var that = this;
			generateValuesTest([
						{ key: "setValue", value: "4:15:55" }
					],
					{
						expInputVal: that._defaultFormatter.format(getDate(4, 15, 55)),
						expValue: "4:15:55",
						expDateValue: getDate(4, 15, 55)
					});
		});

		test(getID(), function() {
			var that = this;
			generateValuesTest([
						{ key: "setValue", value: that._defaultFormatter.format(getDate(17, 27, 43)) },
						{ key: "setDisplayFormat", value: "HH:mm" }
					],
					{
						expInputVal: "17:27",
						expValue: that._defaultFormatter.format(getDate(17, 27, 43)),
						expDateValue: getDate(17, 27, 43)
					});
		});

		test(getID(), function() {
			var that = this;
			generateValuesTest([
						{ key: "setDisplayFormat", value: "HH:mm" },
						{ key: "setValue", value:  that._defaultFormatter.format(getDate(17, 5, 33)) }
					],
					{
						expInputVal: "17:05",
						expValue:  that._defaultFormatter.format(getDate(17, 5, 33)),
						expDateValue: getDate(17, 5, 33)
					});
		});

		test(getID(), function() {
			var that = this;
			generateValuesTest([
						{ key: "setDisplayFormat", value: "HH:mm" },
						{ key: "setDateValue", value: getDate(17, 27, 43) }
					],
					{
						expInputVal: "17:27",
						expValue: that._defaultFormatter.format(getDate(17, 27, 43)),
						expDateValue: getDate(17, 27, 43)
					});
		});

		test(getID(), function() {
			var that = this;
			generateValuesTest([
						{ key: "setDateValue", value: getDate(17, 27, 43) },
						{ key: "setDisplayFormat", value: "HH:mm" }
					],
					{
						expInputVal: "17:27",
						expValue: that._defaultFormatter.format(getDate(17, 27, 43)),
						expDateValue: getDate(17, 27, 43)
					});
		});

		test(getID(), function() {
			var that = this;
			generateValuesTest([
						{ key: "setDateValue", value: getDate(17, 27, 43) },
						{ key: "setValue", value: that._defaultFormatter.format(getDate(18, 37, 23)) }
					],
					{
						expInputVal: that._defaultFormatter.format(getDate(18, 37, 23)),
						expValue: that._defaultFormatter.format(getDate(18, 37, 23)),
						expDateValue: getDate(18, 37, 23)
					});
		});

		test(getID(), function() {
			var that = this;
			generateValuesTest([
						{ key: "setValue", value: that._defaultFormatter.format(getDate(6, 37, 23)) },
						{ key: "setDateValue", value: getDate(5, 28, 40) }
					],
					{
						expInputVal: that._defaultFormatter.format(getDate(5, 28, 40)),
						expValue: that._defaultFormatter.format(getDate(5, 28, 40)),
						expDateValue: getDate(5, 28, 40)
					});
		});

		test(getID(), function() {
			var that = this;
			generateValuesTest([
						{ key: "setValue", value: that._defaultFormatter.format(getDate(6, 37, 23)) },
						{ key: "setDisplayFormat", value: "hh:mm a" },
						{ key: "setDateValue", value: getDate(5, 28, 40) }
					],
					{
						expInputVal: sap.ui.core.format.DateFormat.getTimeInstance({pattern: "hh:mm a", strictParsing: true, relative: false}).format(getDate(5, 28, 40)),
						expValue: that._defaultFormatter.format(getDate(5, 28, 40)),
						expDateValue: getDate(5, 28, 40)
					});
		});

		test(getID(), function() {
			var that = this;
			generateValuesTest([
						{ key: "setValue", value: that._defaultFormatter.format(getDate(6, 37, 23)) },
						{ key: "setDateValue", value: getDate(5, 28, 40) },
						{ key: "setDisplayFormat", value: "hh:mm a" }
					],
					{
						expInputVal: sap.ui.core.format.DateFormat.getTimeInstance({pattern: "hh:mm a", strictParsing: true, relative: false}).format(getDate(5, 28, 40)),
						expValue: that._defaultFormatter.format(getDate(5, 28, 40)),
						expDateValue: getDate(5, 28, 40)
					});
		});

		test(getID(), function() {
			generateValuesTest([
						{ key: "setValueFormat", value: "HH:mm" },
						{ key: "setValue", value: "18:37" },
						{ key: "setDisplayFormat", value: "hh:mm:ss a" }
					],
					{
						expInputVal: sap.ui.core.format.DateFormat.getTimeInstance({pattern: "hh:mm:ss a", strictParsing: true, relative: false}).format(getDate(18, 37, 0)),
						expValue:  "18:37",
						expDateValue: getDate(18, 37, 0)
					});
		});

		test(getID(), function() {
			generateValuesTest([
						{ key: "setValueFormat", value: "HH:mm" },
						{ key: "setValue", value: "18:37" },
						{ key: "setDisplayFormat", value: "hh a" }
					],
					{
						expInputVal: sap.ui.core.format.DateFormat.getTimeInstance({pattern: "hh a", strictParsing: true, relative: false}).format(getDate(18, 37, 0)),
						expValue: "18:37",
						expDateValue: getDate(18, 37, 0)
					});
		});

		test(getID(), function() {
			generateValuesTest([
						{ key: "setValueFormat", value: "HH:mm" },
						{ key: "setDateValue", value: getDate(18, 37, 0) },
						{ key: "setDisplayFormat", value: "hh a" }
					],
					{
						expInputVal: sap.ui.core.format.DateFormat.getTimeInstance({pattern: "hh a", strictParsing: true, relative: false}).format(getDate(18, 37, 0)),
						expValue: "18:37",
						expDateValue: getDate(18, 37, 0)
					});
		});

		test("test locale", function() {
			generateValuesTest([
						{ key: "setValueFormat", value: "hh:mm a" },
						{ key: "setValue", value: "11:50 nachm." },
						{ key: "setDisplayFormat", value: "hh:mm a" },
						{ key: "setLocaleId", value: "de_DE"}
					],
					{
						expInputVal: "11:50 nachm.",
						expValue: "11:50 nachm.",
						expDateValue: getDate(23, 50, 0)
					});
		});

		test("test default locale", function () {
			var stub = sinon.stub(sap.ui.getCore().getConfiguration(), 'getFormatLocale').returns('ar');
			//Test default browser locale set to arabic
			generateValuesTest([
				{ key: "setDisplayFormat", value: "hh:mm:ss a"},
				{ key: "setValueFormat", value: "hh:mm a"},
				{ key: "setDateValue", value: getDate(23, 32, 0)}
			], {
				expInputVal: "11:32:00 م",
				expValue: "11:32 م",
				expDateValue: getDate(23, 32, 0)
			});
			//Test default browser local set to arabic and also custom TimePicker locale set to German
			generateValuesTest([
				{ key: "setLocaleId", value: "de_DE"},
				{ key: "setValueFormat", value: "h:mm a" },
				{ key: "setDisplayFormat", value: "hh:mm:ss a" },
				{ key: "setDateValue", value: getDate(17, 23, 18) }
			],
			{
				expValue: "5:23 nachm.",
				expInputVal: "05:23:18 nachm.",
				expDateValue: getDate(17, 23, 18)
			});

			stub.restore();
		});

		test("Value is validated when setValue is called with null or undefined", function () {
			var oTP = new sap.m.TimePicker({
					displayFormat: "HH:mm"
				});

			oTP.placeAt('qunit-fixture');
			sap.ui.getCore().applyChanges();

			oTP.setValue(null);
			strictEqual(oTP.getValue(), "", "'getValue' is updated and returns correct VALIDATED value");
			oTP.setValue(undefined);
			strictEqual(oTP.getValue(), "", "'getValue' is updated and returns correct VALIDATED value");

			oTP.destroy();
		});

		module("Keyboard handling of picker");

		test("initial focus", function() {
			var tp = new sap.m.TimePicker();
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			tp._openPicker();
			this.clock.tick(1000);

			var $firstSlider = tp._getSliders().getAggregation("_columns")[0];
			var oSliderFocusSpy = this.spy($firstSlider, "focus");

			ok(oSliderFocusSpy.callCount >= 0, "picker exists and its first slider is focussed at some point");

			//cleanup
			tp.destroy();
			$firstSlider.focus.restore();
		});

		test("arrow left", function() {
			var tp = new sap.m.TimePicker();
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			tp._openPicker();
			this.clock.tick(1000);

			var $oElement = document.activeElement;
			var sliders = tp._getSliders();
			var firstSlider = sliders.getAggregation("_columns")[0];
			var lastSlider = sliders.getAggregation("_columns")[3];
			var secondLastSlider = sliders.getAggregation("_columns")[2];

			equal($oElement.id, firstSlider.getId(), "picker exists and first slider is the current focussed element");

			qutils.triggerKeydown(sliders.getDomRef(), jQuery.sap.KeyCodes.ARROW_LEFT);
			this.clock.tick(1);

			$oElement = document.activeElement;
			equal($oElement.id, lastSlider.getId(), "the last slider is the focussed element");

			qutils.triggerKeydown(sliders.getDomRef(), jQuery.sap.KeyCodes.ARROW_LEFT);
			this.clock.tick(1);

			$oElement = document.activeElement;
			equal($oElement.id, secondLastSlider.getId(), "the second last slider is the focussed element");

			//cleanup
			tp.destroy();
		});


		test("arrow right", function() {
			var tp = new sap.m.TimePicker();
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			tp._openPicker();
			this.clock.tick(1000);

			var $oElement = document.activeElement;
			var sliders = tp._getSliders();
			var firstSlider = sliders.getAggregation("_columns")[0];
			var secondSlider = sliders.getAggregation("_columns")[1];

			equal($oElement.id, firstSlider.getId(), "picker exists and first slider is the current focussed element");

			qutils.triggerKeydown(sliders.getDomRef(), jQuery.sap.KeyCodes.ARROW_RIGHT);
			this.clock.tick(1);

			$oElement = document.activeElement;
			equal($oElement.id, secondSlider.getId(), "the second slider is the focussed element");

			qutils.triggerKeydown(sliders.getDomRef(), jQuery.sap.KeyCodes.ARROW_RIGHT);
			this.clock.tick(1);
			qutils.triggerKeydown(sliders.getDomRef(), jQuery.sap.KeyCodes.ARROW_RIGHT);
			this.clock.tick(1);
			qutils.triggerKeydown(sliders.getDomRef(), jQuery.sap.KeyCodes.ARROW_RIGHT);
			this.clock.tick(1);

			$oElement = document.activeElement;
			equal($oElement.id, firstSlider.getId(), "the first slider is the focussed element again");

			//cleanup
			tp.destroy();
		});

		test("end and home", function() {
			var tp = new sap.m.TimePicker();
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			tp._openPicker();
			this.clock.tick(1000);

			var $oElement = document.activeElement;
			var sliders = tp._getSliders();
			var firstSlider = sliders.getAggregation("_columns")[0];
			var lastSlider = sliders.getAggregation("_columns")[3];

			qutils.triggerKeydown(sliders.getDomRef(), jQuery.sap.KeyCodes.END);
			this.clock.tick(1);

			$oElement = document.activeElement;
			equal($oElement.id, lastSlider.getId(), "the last slider is the focussed element");

			qutils.triggerKeydown(sliders.getDomRef(), jQuery.sap.KeyCodes.HOME);
			this.clock.tick(1);

			$oElement = document.activeElement;
			equal($oElement.id, firstSlider.getId(), "the first slider is the focussed element again");

			//cleanup
			tp.destroy();
		});

		test("pageup and pagedown", function() {
			var tp = new sap.m.TimePicker();
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			tp._openPicker();
			this.clock.tick(1000);

			var sliders = tp._getSliders();
			var firstSlider = sliders.getAggregation("_columns")[0];

			qutils.triggerKeydown(firstSlider.getDomRef(), jQuery.sap.KeyCodes.PAGE_UP);
			this.clock.tick(1);


			equal(firstSlider.getSelectedValue(), firstSlider.getItems()[0].getKey(), "the selected value is the first value");

			qutils.triggerKeydown(firstSlider.getDomRef(), jQuery.sap.KeyCodes.PAGE_DOWN);
			this.clock.tick(1);

			equal(firstSlider.getSelectedValue(), firstSlider.getItems()[firstSlider.getItems().length - 1].getKey(), "the selected value is the last value");

			qutils.triggerKeydown(firstSlider.getDomRef(), jQuery.sap.KeyCodes.PAGE_UP);
			this.clock.tick(1);

			equal(firstSlider.getSelectedValue(), firstSlider.getItems()[0].getKey(), "the selected value is the first value again");

			//cleanup
			tp.destroy();
		});

		test("up and down", function() {
			var oDate = new Date();
			oDate.setHours(4);
			var tp = new sap.m.TimePicker({
				dateValue: oDate
			});
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			tp._openPicker();
			this.clock.tick(1000);

			var sliders = tp._getSliders();
			var firstSlider = sliders.getAggregation("_columns")[0];

			qutils.triggerKeydown(firstSlider.getDomRef(), jQuery.sap.KeyCodes.ARROW_UP);
			this.clock.tick(210);


			equal(firstSlider.getSelectedValue(), "3", "the selected value is one value upwards");

			qutils.triggerKeydown(firstSlider.getDomRef(), jQuery.sap.KeyCodes.ARROW_DOWN);
			this.clock.tick(210);

			equal(firstSlider.getSelectedValue(), "4", "the selected value is one value downwards");

			//cleanup
			tp.destroy();
		});

		test("Alt + up", function() {
			var oDate = new Date();
			oDate.setHours(4);
			var tp = new sap.m.TimePicker({
				dateValue: oDate
			});
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			tp._openPicker();
			this.clock.tick(1);

			var sliders = tp._getSliders();
			var firstSlider = sliders.getAggregation("_columns")[0];
			var picker = tp._getPicker();
			var oHandleOkSpy = this.spy(tp, "_handleOkPress");

			//slider one up
			qutils.triggerKeydown(firstSlider.getDomRef(), jQuery.sap.KeyCodes.ARROW_UP);
			this.clock.tick(300);

			//close and save
			qutils.triggerKeydown(firstSlider.getDomRef(), jQuery.sap.KeyCodes.ARROW_UP, false, true, false);
			this.clock.tick(300);

			ok(!picker.isOpen(), "picker is closed");
			equal(oHandleOkSpy.callCount, 1, "the picker date value is saved");

			//cleanup
			tp.destroy();
			tp._handleOkPress.restore();
		});

		test("Alt + down", function() {
			var oDate = new Date();
			oDate.setHours(4);
			var tp = new sap.m.TimePicker({
				dateValue: oDate
			});
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			tp._openPicker();
			this.clock.tick(1);

			var sliders = tp._getSliders();
			var firstSlider = sliders.getAggregation("_columns")[0];
			var picker = tp._getPicker();
			var oHandleOkSpy = this.spy(tp, "_handleOkPress");

			//slider one up
			qutils.triggerKeydown(firstSlider.getDomRef(), jQuery.sap.KeyCodes.ARROW_UP);
			this.clock.tick(300);

			//close and save
			qutils.triggerKeydown(firstSlider.getDomRef(), jQuery.sap.KeyCodes.ARROW_DOWN, false, true, false);
			this.clock.tick(300);

			ok(!picker.isOpen(), "picker is closed");
			equal(oHandleOkSpy.callCount, 1, "the picker date value is saved");

			//cleanup
			tp.destroy();
			tp._handleOkPress.restore();
		});

		module("Keyboard handling of input");

		test("pageup increases the hours", function() {
			//arrange
			var oDate = new Date();
			oDate.setHours(5);

			//sut
			var tp = new sap.m.TimePicker({
				dateValue: oDate
			});
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//arrange
			tp.focus();

			//act
			qutils.triggerKeydown(tp.getDomRef(), jQuery.sap.KeyCodes.PAGE_UP);

			//assert
			equal(tp.getDateValue().getHours(), 6, "The time picker hours are increased");

			//cleanup
			tp.destroy();
		});

		test("pagedown decreases the hours", function() {
			//arrange
			var oDate = new Date();
			oDate.setHours(5);

			//sut
			var tp = new sap.m.TimePicker({
				dateValue: oDate
			});
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//arrange
			tp.focus();

			//act
			qutils.triggerKeydown(tp.getDomRef(), jQuery.sap.KeyCodes.PAGE_DOWN);

			//assert
			equal(tp.getDateValue().getHours(), 4, "The time picker hours are decreased");

			//cleanup
			tp.destroy();
		});

		test("pageup does not have side effects", function() {
			//arrange
			var oDate = new Date();
			oDate.setMinutes(20);
			oDate.setSeconds(21);

			//sut
			var tp = new sap.m.TimePicker({
				dateValue: oDate
			});
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//arrange
			tp.focus();

			//act
			qutils.triggerKeydown(tp.getDomRef(), jQuery.sap.KeyCodes.PAGE_UP);

			//assert
			equal(tp.getDateValue().getMinutes(), 20, "The time picker minutes stay the same");
			equal(tp.getDateValue().getSeconds(), 21, "The time picker seconds stay the same");
			ok(!tp._getPicker(), "picker is missing");

			//cleanup
			tp.destroy();
		});

		test("shift+pageup increases the minutes", function() {
			//arrange
			var oDate = new Date();
			oDate.setMinutes(15);

			//sut
			var tp = new sap.m.TimePicker({
				dateValue: oDate
			});
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//arrange
			tp.focus();

			//act
			qutils.triggerKeydown(tp.getDomRef(), jQuery.sap.KeyCodes.PAGE_UP, true, false, false);

			//assert
			equal(tp.getDateValue().getMinutes(), 16, "The time picker minutes are increased");

			//cleanup
			tp.destroy();
		});

		test("shift+pagedown decreases the minutes", function() {
			//arrange
			var oDate = new Date();
			oDate.setMinutes(13);

			//sut
			var tp = new sap.m.TimePicker({
				dateValue: oDate
			});
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//arrange
			tp.focus();

			//act
			qutils.triggerKeydown(tp.getDomRef(), jQuery.sap.KeyCodes.PAGE_DOWN, true, false, false);

			//assert
			equal(tp.getDateValue().getMinutes(), 12, "The time picker minutes are decreased");

			//cleanup
			tp.destroy();
		});

		test("shift+pageup does not have side effects", function() {
			//arrange
			var oDate = new Date();
			oDate.setHours(5);
			oDate.setSeconds(21);

			//sut
			var tp = new sap.m.TimePicker({
				dateValue: oDate
			});
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//arrange
			tp.focus();

			//act
			qutils.triggerKeydown(tp.getDomRef(), jQuery.sap.KeyCodes.PAGE_UP, true, false, false);

			//assert
			equal(tp.getDateValue().getHours(), 5, "The time picker hours stay the same");
			equal(tp.getDateValue().getSeconds(), 21, "The time picker seconds stay the same");
			ok(!tp._getPicker(), "picker is missing");

			//cleanup
			tp.destroy();
		});

		test("ctrl+shift+pageup increases the seconds", function() {
			//arrange
			var oDate = new Date();
			oDate.setSeconds(11);

			//sut
			var tp = new sap.m.TimePicker({
				dateValue: oDate
			});
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//arrange
			tp.focus();

			//act
			qutils.triggerKeydown(tp.getDomRef(), jQuery.sap.KeyCodes.PAGE_UP, true, false, true);

			//assert
			equal(tp.getDateValue().getSeconds(), 12, "The time picker seconds are increased");

			//cleanup
			tp.destroy();
		});

		test("ctrl+shift+pagedown decreases the seconds", function() {
			//arrange
			var oDate = new Date();
			oDate.setSeconds(4);

			//sut
			var tp = new sap.m.TimePicker({
				dateValue: oDate
			});
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//arrange
			tp.focus();

			//act
			qutils.triggerKeydown(tp.getDomRef(), jQuery.sap.KeyCodes.PAGE_DOWN, true, false, true);

			//assert
			equal(tp.getDateValue().getSeconds(), 3, "The time picker seconds are decreased");

			//cleanup
			tp.destroy();
		});

		test("ctrl+pageup does not have side effects", function() {
			//arrange
			var oDate = new Date();
			oDate.setHours(5);
			oDate.setMinutes(38);

			//sut
			var tp = new sap.m.TimePicker({
				dateValue: oDate
			});
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//arrange
			tp.focus();

			//act
			qutils.triggerKeydown(tp.getDomRef(), jQuery.sap.KeyCodes.PAGE_UP, false, false, true);

			//assert
			equal(tp.getDateValue().getHours(), 5, "The time picker hours stay the same");
			equal(tp.getDateValue().getMinutes(), 38, "The time picker minutes stay the same");
			ok(!tp._getPicker(), "picker is missing");

			//cleanup
			tp.destroy();
		});

		test("arrow up opens the picker", function() {
			//sut
			var tp = new sap.m.TimePicker();
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//arrange
			tp.focus();

			//assert
			ok(!tp._getPicker(), "picker does not exist");

			//act
			qutils.triggerKeydown(tp.getDomRef(), jQuery.sap.KeyCodes.ARROW_UP, false, true, false);

			//assert
			ok(tp._getPicker().isOpen(), "picker is open");

			//cleanup
			tp.destroy();
		});

		test("arrow down opens the picker", function() {
			//sut
			var tp = new sap.m.TimePicker();
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//arrange
			tp.focus();

			//assert
			ok(!tp._getPicker(), "picker does not exist");

			//act
			qutils.triggerKeydown(tp.getDomRef(), jQuery.sap.KeyCodes.ARROW_DOWN, false, true, false);

			//assert
			ok(tp._getPicker().isOpen(), "picker is open");

			//cleanup
			tp.destroy();
		});

		test("right moves the cursor but jumps over the immutable chars", function() {
			//arrange
			var oDate = new Date();
			oDate.setHours(5);
			oDate.setMinutes(38);

			//sut
			var tp = new sap.m.TimePicker({
				dateValue: oDate,
				displayFormat: "HH:mm"
			});
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//arrange
			tp.focus();

			//act
			qutils.triggerKeydown(tp.getDomRef(), jQuery.sap.KeyCodes.ARROW_RIGHT, false, false, false);
			qutils.triggerKeydown(tp.getDomRef(), jQuery.sap.KeyCodes.ARROW_RIGHT, false, false, false);

			//assert
			equal(jQuery(tp.getFocusDomRef()).cursorPos(), 3, "After right + right the cursor is at the first minute digit");

			//cleanup
			tp.destroy();
		});

		test("left moves the cursor but jumps over the immutable chars", function() {
			//arrange
			var oDate = new Date();
			oDate.setHours(5);
			oDate.setMinutes(38);

			//sut
			var tp = new sap.m.TimePicker({
				dateValue: oDate,
				displayFormat: "HH:mm"
			});
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//arrange
			tp.focus();

			jQuery(tp.getFocusDomRef()).cursorPos(3);
			equal(jQuery(tp.getFocusDomRef()).cursorPos(), 3, "Initially the cursor is at the first minute digit");

			qutils.triggerKeydown(tp.getDomRef(), jQuery.sap.KeyCodes.ARROW_LEFT, false, false, false);
			equal(jQuery(tp.getFocusDomRef()).cursorPos(), 1, "After left the cursor is at the second hour digit");

			//cleanup
			tp.destroy();
		});

		module("picker interaction");

		test("cancel button closes the picker", function() {
			//sut
			var tp = new sap.m.TimePicker();
			var oBtnCancel, oPopoverCloseSpy;
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//arrange
			tp._openPicker();

			oPopoverCloseSpy = this.spy(tp._getPicker(), "close");
			oBtnCancel = tp._getPicker().getEndButton();

			//act
			oBtnCancel.firePress();

			equal(oPopoverCloseSpy.callCount, 1, "At the end cancel button invokes the popover's close method");

			//cleanup
			tp._getPicker().close.restore();
			tp.destroy();
		});

		module("data binding");

		test("binding to value property is correct", function() {
			//sut
			var tp = new sap.m.TimePicker({
				value: {
					path: "/timeValue",
					type: new sap.ui.model.type.Time({pattern: "HH:mm", strictParsing: true})
				}
			});

			//arrange
			var oModel = new sap.ui.model.json.JSONModel();
			var oDate = new Date(2000, 1, 2, 16, 35, 54);
			var oDate2 = new Date(2000, 1, 2, 20, 10, 11);
			oModel.setData({
				timeValue: oDate
			});

			tp.setModel(oModel);

			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//act

			//assert
			equal(tp.getValue(), "16:35", "the value property is set in and formatted correctly");

			//act
			oModel.setData({
				timeValue: oDate2
			});

			//assert
			equal(tp.getValue(), "20:10", "the value property has changed with the model");

			//cleanup
			tp.destroy();
		});

		module("slider interactions", {
			_createMouseWheelEvent: function(iWheelSteps) {
				var oEvent = {};
				oEvent.originalEvent = {};
				oEvent.originalEvent.wheelDelta = iWheelSteps * 120;
				oEvent.originalEvent.detail = iWheelSteps * -3;
				oEvent.preventDefault = function() {};
				oEvent.stopPropagation = function() {};

				return oEvent;
			}
		});

		test("fireTap expands slider", function() {
			//sut
			var tp = new sap.m.TimePicker();
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//arrange
			tp._openPicker();
			this.clock.tick(1);

			var sliders = tp._getSliders();
			var sliderMinutes = sliders.getAggregation("_columns")[1];

			ok(!sliderMinutes.getIsExpanded(), "slider is collapsed");

			//act
			sliderMinutes.fireTap(null);

			//assert
			ok(sliderMinutes.getIsExpanded(), "slider is expanded");

			//cleanup
			tp.destroy();
		});

		test("_getUpdatedCycleScrollTop returns a new top value with the right offset", function() {
			//sut
			var tp = new sap.m.TimePicker();
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//arrange
			tp._openPicker();
			this.clock.tick(1);

			var sliders = tp._getSliders();
			var sliderHours = sliders.getAggregation("_columns")[0];
			sliderHours._bIsDrag = true;

			var params = [
				600, //$ContainerHeight
				5000, //$ContentHeight,
				100, //current top position
				150, //dragMargin
				5 //contentRepeat value
			];

			//act
			var updatedTop = sliderHours._getUpdatedCycleScrollTop.apply(sliderHours, params);

			//assert
			equal(updatedTop, 1100, "_getUpdatedCycleScrollTop has jumped top by one time the unique content height");

			//cleanup
			tp.destroy();
		});

		test("_doDrag method updates the top position", function() {
			//sut
			var tp = new sap.m.TimePicker();
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//arrange
			tp._openPicker();
			this.clock.tick(1);

			var sliders = tp._getSliders();
			var sliderHours = sliders.getAggregation("_columns")[0];

			//act
			sliderHours._startDrag(200);
			sliderHours._bIsDrag = true;

			var oJQueryScrollTopSpy = this.spy(jQuery.fn, "scrollTop");
			sliderHours._doDrag(240, 1435829481235);
			sliderHours._doDrag(293, 1435829481277);

			//assert
			equal(oJQueryScrollTopSpy.callCount, 2, "slider's top position has been updated once for every _doDrag");

			//cleanup
			jQuery.fn.scrollTop.restore();
			tp.destroy();
		});

		test("_endDrag method initiates an animation on the slider's content", function() {
			//sut
			var tp = new sap.m.TimePicker();
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//arrange
			tp._openPicker();
			this.clock.tick(1);

			var sliders = tp._getSliders();
			var sliderHours = sliders.getAggregation("_columns")[0];
			var oAnimateScrollSpy = this.spy(sliderHours, "_animateScroll");

			//act
			sliderHours._startDrag(200);
			sliderHours._doDrag(240, 1435829481235); //about 40ms offset each drag
			sliderHours._doDrag(293, 1435829481277);
			sliderHours._doDrag(340, 1435829481323);
			sliderHours._doDrag(382, 1435829481364);
			sliderHours._endDrag(439, 1435829481402);

			//assert
			equal(oAnimateScrollSpy.callCount, 1, "animation was started");
			ok(Math.abs(oAnimateScrollSpy.args[0][0]) < 2, "animation was started with reasonable speed");

			//cleanup
			sliderHours._animateScroll.restore();
			tp.destroy();
		});

		test("tap on the input icon open/closes the picker", function() {
			var tp = new sap.m.TimePicker();
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			var icon = tp.$().find(".sapUiIcon");
			icon.tap();
			this.clock.tick(1000);

			strictEqual(jQuery(".sapMPopover").is(":visible"), true, "the picker is opened");

			icon.tap();
			this.clock.tick(1000);

			strictEqual(jQuery(".sapMPopover").is(":visible"), false, "the picker is closed");

			tp.destroy();
		});

		test("mouse wheel scrolls the sliders proportionally to the speed", function() {
			//sut
			var tp = new sap.m.TimePicker({
					displayFormat: "HH:mm",
					dateValue: new Date(2000, 1, 2, 16, 35, 54)
				}),
				oEvent,
				oSliders,
				oSliderHours;

			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//arrange
			tp._openPicker();
			this.clock.tick(1000); //wait the initial focus of the first slider

			oSliders = tp._getSliders();
			oSliderHours = oSliders.getAggregation("_columns")[0];

			//act
			oEvent = this._createMouseWheelEvent(1);
			oSliders._onmousewheel(oEvent); //these values are inside the event object when we scroll just a little
			this.clock.tick(160);

			//assert
			equals(oSliderHours.getSelectedValue(), "15", "slider's value changed by 1");

			//act again
			oEvent = this._createMouseWheelEvent(-2);
			oSliders._onmousewheel(oEvent);
			this.clock.tick(160);

			//assert
			equals(oSliderHours.getSelectedValue(), "17", "slider's value changed by 2 in the other direction");

			//cleanup
			tp.destroy();
		});

		test("focussed input is styled correctly", function() {
			var tp = new sap.m.TimePicker();
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			tp._openPicker();
			this.clock.tick(1000);

			strictEqual(jQuery(".sapMTPInputActive").is(":visible"), true, "the picker is opened and focussed");

			tp._closePicker();
			this.clock.tick(1000);

			strictEqual(jQuery(".sapMTPInputActive").is(":visible"), false, "the picker is closed and not focussed");

			qutils.triggerEvent("focusout", tp.getDomRef());
			ok(!tp.$().hasClass("sapMTPInputActive"), "the picker is closed and not focussed");


			tp.destroy();
		});

		test("_getInputValue", function() {
			var tp = new sap.m.TimePicker();
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			tp.setValue("10:55:13 AM");
			var result = tp._getInputValue();

			assert.strictEqual(result, "10:55:13 AM", "_getInputValue returns the correct time");

			tp.destroy();
		});

		/* Temporary disabled until robust solution (across all timezones is implemented) test("decrease time when daylight saving begins", function() {
		 var tp = new sap.m.TimePicker();
		 tp.placeAt("qunit-fixture");
		 sap.ui.getCore().applyChanges();

		 tp.setDateValue(new Date(2015, 2, 29, 3, 12, 15));
		 tp._increaseTime(-1, "hour");

		 equal(tp.getDateValue().toString(), new Date(2015, 2, 29, 1, 12, 15).toString(), "_increaseTime works as expected when decreasing in daylight saving");

		 tp.destroy();
		 });*/

		module("properties in constructor options", {
			beforeEach: function() {
				this._defaultFormatter = sap.ui.core.format.DateFormat.getTimeInstance({style: "medium", strictParsing: true, relative: false});
			}
		});

		test("displayFormat after value", function() {
			//system under test
			var tpId = "tp" + ++caseIndex,
					tp = new sap.m.TimePicker(tpId, {
						value: this._defaultFormatter.format(getDate(17, 27, 43)),
						displayFormat: "HH:mm"
					}),
					expDateValue = getDate(17, 27, 43);

			//arrange
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//render

			//assert
			equals(jQuery("#" + tpId + "-inner").val(), "17:27", "$input.val() ok");
			equals(tp.getValue(), this._defaultFormatter.format(getDate(17, 27, 43)), "getValue() ok");

			var oDateValue = tp.getDateValue();
			oDateValue.setFullYear(expDateValue.getFullYear());
			oDateValue.setMonth(expDateValue.getMonth());
			oDateValue.setDate(expDateValue.getDate());
			equals(oDateValue.toString(), expDateValue.toString(), "getDateValue ok");

			//cleanup
			tp.destroy();
		});

		module("Time picker has same behaviour on mobile like on desktop", {
			setup: function () {
				jQuery("html").removeClass("sap-desktop");
				jQuery("html").removeClass("sapUiMedia-Std-Desktop");
				jQuery("html").addClass("sap-phone");
				jQuery("html").addClass("sapUiMedia-Std-Phone");
			},
			teardown: function () {
				jQuery("html").removeClass("sap-phone");
				jQuery("html").removeClass("sapUiMedia-Std-Phone");
				jQuery("html").addClass("sap-desktop");
				jQuery("html").addClass("sapUiMedia-Std-Desktop");
			}
		});

		test("focus on the input does not open the picker on mobile", function() {
			//system under test
			var tp = new sap.m.TimePicker('tp');

			// arrange
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			// act
			qutils.triggerEvent("focusin", tp.getDomRef());

			strictEqual(tp.$().hasClass("sapMFocus"), true, "the input is focused");
			strictEqual(tp._getPicker(), null, "the picker is not opened");

			//cleanup
			tp.destroy();
		});

		module("MaskInput integration", {
			beforeEach : function() {
				this._defaultFormatter = sap.ui.core.format.DateFormat.getTimeInstance({style: "medium", strictParsing: true, relative: false});
				this._leadingZero24HFormatter = sap.ui.core.format.DateFormat.getTimeInstance({pattern: "HH:mm:ss", strictParsing: true, relative: false});
				this._leadingZero12HFormatter = sap.ui.core.format.DateFormat.getTimeInstance({pattern: "hh:mm a", strictParsing: true, relative: false});
				this._noLeadingZero24HFormatter = sap.ui.core.format.DateFormat.getTimeInstance({pattern: "H:mm:ss", strictParsing: true, relative: false});
				this._noLeadingZero12HFormatter = sap.ui.core.format.DateFormat.getTimeInstance({pattern: "h:mm a", strictParsing: true, relative: false});
			},
			typeAndCheckValueForDisplayFormat: function(sDisplayFormat, sInput, sExpectedValue) {
				//system under test
				var tp = new sap.m.TimePicker({
					displayFormat: sDisplayFormat
				});

				//arrange
				tp.placeAt("qunit-fixture");
				sap.ui.getCore().applyChanges();

				//act
				triggerMultipleKeypress(tp, sInput);

				//assert
				equals(jQuery("#" + tp.getId() + "-inner").val(), sExpectedValue, "$input.val() ok");

				//cleanup
				tp.destroy();
			}
		});

		//valid
		test("allows input of valid time string - HH format, hours < 9", function() {
			this.typeAndCheckValueForDisplayFormat("HH:mm", "0615", "06:15");
		});

		test("allows input of valid time string - HH format, hours === 11", function() {
			this.typeAndCheckValueForDisplayFormat("HH:mm", "1115", "11:15");
		});

		test("allows input of valid time string - HH format, hours > 12", function() {
			this.typeAndCheckValueForDisplayFormat("HH:mm", "1715", "17:15");
		});

		test("allows input of valid time string - hh format, hours < 9", function() {
			this.typeAndCheckValueForDisplayFormat("hh:mm", "0615", "06:15");
		});

		test("allows input of valid time string - hh format, hours === 12", function() {
			this.typeAndCheckValueForDisplayFormat("hh:mm", "1215", "12:15");
		});



		//time semantics - shifts and replaces
		//first number in hour
		//no leading zero
		test("1 for first hour digit is valid - h format, pos 0", function() {
			this.typeAndCheckValueForDisplayFormat("h:mm", "115", "11:5-"); //not " 1:15"
		});

		test("2 for first hour digit are preceded by space - h format, pos 0", function() {
			this.typeAndCheckValueForDisplayFormat("h:mm", "215", " 2:15");
		});

		test("numbers > 2 for first hour digit are preceded by space - h format, pos 0", function() {
			this.typeAndCheckValueForDisplayFormat("h:mm", "315", " 3:15");
		});



		test("2 for first hour digit is valid - H format, pos 0", function() {
			this.typeAndCheckValueForDisplayFormat("H:mm", "215", "21:5-"); //not " 2:15"
		});

		test("numbers > 2 for first hour digit are preceded by space - H format, pos 0", function() {
			this.typeAndCheckValueForDisplayFormat("H:mm", "315", " 3:15");
		});


		test("space is valid for hours - H format, pos 0", function() {
			this.typeAndCheckValueForDisplayFormat("H:mm", " 115", " 1:15"); //not "11:5-"
		});

		//...could have more of those

		test("0 is replaced with space for hours - h format, pos 0", function() {
			this.typeAndCheckValueForDisplayFormat("h:mm", "0115", " 1:15");
		});

		test("0 is preceeded with space for hours - H format, pos 0", function() {
			this.typeAndCheckValueForDisplayFormat("H:mm", "0115", " 0:11");
		});


		//leading zero
		test("1 for first hour digit is valid - hh format, pos 0", function() {
			this.typeAndCheckValueForDisplayFormat("hh:mm", "115", "11:5-");
		});

		test("2 for first hour digit are preceded by 0 - hh format, pos 0", function() {
			this.typeAndCheckValueForDisplayFormat("hh:mm", "215", "02:15");
		});



		test("2 for first hour digit is valid - HH format, pos 0", function() {
			this.typeAndCheckValueForDisplayFormat("HH:mm", "215", "21:5-"); //not " 2:15"
		});

		test("numbers > 2 for first hour digit are preceded by 0 - HH format, pos 0", function() {
			this.typeAndCheckValueForDisplayFormat("HH:mm", "415", "04:15");
		});




		test("space is replaced with 0 for hours - HH format, pos 0", function() {
			this.typeAndCheckValueForDisplayFormat("HH:mm", " 115", "01:15");
		});

		test("0 is valid for hours - hh format, pos 0", function() {
			this.typeAndCheckValueForDisplayFormat("hh:mm", "0115", "01:15"); //not "11:5-"
		});



		//invalid (partially valid)
		test("do not allow letters, placeholders, immutables and asterisks - HH format", function() {
			this.typeAndCheckValueForDisplayFormat("HH:mm", "-:aQ*?spam1", "1-:--");
		});

		test("do not allow letters, placeholders, immutables and asterisks - hh format", function() {
			this.typeAndCheckValueForDisplayFormat("hh:mm", "-1:spamaQ1*?", "11:--");
		});

		//second number in hour
		test("do not allow numbers > 2 for 2nd number in hour if 1st === 1 - hh format", function() {
			this.typeAndCheckValueForDisplayFormat("hh:mm", "13", "1-:--");
		});

		test("allow numbers <= 2 for 2nd number in hour if 1st === 1 - hh format", function() {
			this.typeAndCheckValueForDisplayFormat("hh:mm", "12", "12:--");
		});

		test("do not allow numbers > 2 for 2nd number in hour if 1st === 1 - h format", function() {
			this.typeAndCheckValueForDisplayFormat("h:mm", "13", "1-:--");
		});

		test("allow numbers <= 2 for 2nd number in hour if 1st === 1 - h format", function() {
			this.typeAndCheckValueForDisplayFormat("h:mm", "12", "12:--");
		});



		test("do not allow numbers > 3 for 2nd number in hour if 1st === 2 - HH format", function() {
			this.typeAndCheckValueForDisplayFormat("HH:mm", "24", "2-:--");
		});

		test("allow numbers <= 3 for 2nd number in hour if 1st === 2 - HH format", function() {
			this.typeAndCheckValueForDisplayFormat("HH:mm", "23", "23:--");
		});

		test("do not allow numbers > 3 for 2nd number in hour if 1st === 2 - H format", function() {
			this.typeAndCheckValueForDisplayFormat("H:mm", "24", "2-:--");
		});

		test("allow numbers <= 3 for 2nd number in hour if 1st === 2 - H format", function() {
			this.typeAndCheckValueForDisplayFormat("H:mm", "23", "23:--");
		});

		//first number in minutes
		test("numbers > 5 for 1st number in minutes are preceded by 0", function() {
			this.typeAndCheckValueForDisplayFormat("HH:mm", "226", "22:06");
		});

		test("allow numbers <= 5 for 1st number in minutes", function() {
			this.typeAndCheckValueForDisplayFormat("HH:mm", "225", "22:5-");
		});

		//we probably do not need this separately
		test("allow 0 for 1st number in minutes", function() {
			this.typeAndCheckValueForDisplayFormat("HH:mm", "220", "22:0-");
		});

		//first number in seconds
		test("numbers > 5 for 1st number in seconds are preceded by 0", function() {
			this.typeAndCheckValueForDisplayFormat("HH:mm:ss", "22556", "22:55:06");
		});

		test("allow numbers <= 5 for 1st number in seconds", function() {
			this.typeAndCheckValueForDisplayFormat("HH:mm:ss", "22595", "22:59:5-");
		});

		//am/pm values type assistence
		test("am autocompletes the value on first different letter", function() {
			this.typeAndCheckValueForDisplayFormat("hh a", "01A", "01 AM");
		});

		test("pm autocompletes the value on first different letter", function() {
			this.typeAndCheckValueForDisplayFormat("hh a", "01P", "01 PM");
		});

		test("on enter '15:--:--', autocomplete to '15:00:00'", function() {
			//system under test
			var oTp = new sap.m.TimePicker({
				displayFormat: "HH:mm:ss"
			});

			//arrange
			oTp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//act
			triggerMultipleKeypress(oTp, "15");
			qutils.triggerKeydown(jQuery(oTp.getFocusDomRef()), jQuery.sap.KeyCodes.ENTER);

			//assert
			equals(jQuery("#" + oTp.getId() + "-inner").val(), "15:00:00", "$input.val() ok");

			//cleanup
			oTp.destroy();
		});

		test("on enter '15:1-:--', autocomplete to '15:01:00'", function() {
			//system under test
			var oTp = new sap.m.TimePicker({
				displayFormat: "HH:mm:ss"
			});

			//arrange
			oTp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//act
			triggerMultipleKeypress(oTp, "151");
			qutils.triggerKeydown(jQuery(oTp.getFocusDomRef()), jQuery.sap.KeyCodes.ENTER);
			//assert
			equals(jQuery("#" + oTp.getId() + "-inner").val(), "15:01:00", "$input.val() ok");

			//cleanup
			oTp.destroy();
		});

		test("on enter '07:-- --', autocomplete to '07:00 AM'", function() {
			//system under test
			var oTp = new sap.m.TimePicker({
				displayFormat: "HH:mm a"
			});

			//arrange
			oTp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();
			//focus is explicitly needed, because sending a single key ('7' - see below) does not focus the element.
			jQuery(oTp).focus();
			this.clock.tick(1000);

			//act
			triggerMultipleKeypress(oTp, "7");
			qutils.triggerKeydown(jQuery(oTp.getFocusDomRef()), jQuery.sap.KeyCodes.ENTER);
			//assert
			equals(jQuery("#" + oTp.getId() + "-inner").val(), "07:00 AM", "$input.val() ok");

			//cleanup
			oTp.destroy();
		});

		test("am match start - then autocomplete on any letter", function() {
			//system under test
			var tp = new sap.m.TimePicker({
				valueFormat: "hh a",
				value: "12 AM",
				displayFormat: "hh a"
			});

			//arrange
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			qutils.triggerKeydown(jQuery(tp.getFocusDomRef()), jQuery.sap.KeyCodes.ARROW_RIGHT);
			qutils.triggerKeydown(jQuery(tp.getFocusDomRef()), jQuery.sap.KeyCodes.ARROW_RIGHT);
			qutils.triggerKeydown(jQuery(tp.getFocusDomRef()), jQuery.sap.KeyCodes.ARROW_RIGHT);
			qutils.triggerKeydown(jQuery(tp.getFocusDomRef()), jQuery.sap.KeyCodes.ARROW_RIGHT);
			qutils.triggerKeydown(jQuery(tp.getFocusDomRef()), jQuery.sap.KeyCodes.BACKSPACE);

			equals(jQuery("#" + tp.getId() + "-inner").val(), "12 A-", "$input.val() correctly preset");

			triggerMultipleKeypress(tp, "y");

			//assert
			equals(jQuery("#" + tp.getId() + "-inner").val(), "12 AM", "$input.val() ok");

			//cleanup
			tp.destroy();
		});

		test("minutes only values are correctly synced with the input", function() {
			//system under test
			var oTp = new sap.m.TimePicker({
				displayFormat: "mm"
			});

			//arrange
			oTp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//act
			triggerMultipleKeypress(oTp, "15");
			qutils.triggerKeydown(jQuery(oTp.getFocusDomRef()), jQuery.sap.KeyCodes.ENTER);

			//assert
			equals(jQuery("#" + oTp.getId() + "-inner").val(), "15", "$input.val() ok");

			//cleanup
			oTp.destroy();
		});

		test("pm match start - then autocomplete on any letter", function() {
			//system under test
			var tp = new sap.m.TimePicker({
				valueFormat: "hh a",
				value: "12 PM",
				displayFormat: "hh a"
			});

			//arrange
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			qutils.triggerKeydown(jQuery(tp.getFocusDomRef()), jQuery.sap.KeyCodes.ARROW_RIGHT);
			qutils.triggerKeydown(jQuery(tp.getFocusDomRef()), jQuery.sap.KeyCodes.ARROW_RIGHT);
			qutils.triggerKeydown(jQuery(tp.getFocusDomRef()), jQuery.sap.KeyCodes.ARROW_RIGHT);
			qutils.triggerKeydown(jQuery(tp.getFocusDomRef()), jQuery.sap.KeyCodes.ARROW_RIGHT);
			qutils.triggerKeydown(jQuery(tp.getFocusDomRef()), jQuery.sap.KeyCodes.BACKSPACE);

			equals(jQuery("#" + tp.getId() + "-inner").val(), "12 P-", "$input.val() correctly preset");

			triggerMultipleKeypress(tp, "b");

			//assert
			equals(jQuery("#" + tp.getId() + "-inner").val(), "12 PM", "$input.val() ok");

			//cleanup
			tp.destroy();
		});

		test("TimeSemanticMaskHelper.replaceChar replaces any char when am or pm value match is the only possible", function() {
			//system under test
			var tp = new sap.m.TimePicker({
				displayFormat: "hh a"
			});

			//arrange
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			var sCharReplaced = tp._oTimeSemanticMaskHelper.replaceChar("y", 4, "12 P-");

			equals(sCharReplaced, "M", "replaceChar replaces correctly");

			//cleanup
			tp.destroy();
		});

		test("TimeSemanticMaskHelper.replaceChar replaces with unique value and completes with spaces when am,pm length differs", function() {
			//system under test
			var tp = new sap.m.TimePicker({
				localeId: "de_DE",
				displayFormat: "hh a"
			});

			//am/pm translation is - vorm./nachm. - which are different length

			//arrange
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			var sCharReplaced = tp._oTimeSemanticMaskHelper.replaceChar("v", 3, "12 ------");

			equals(sCharReplaced, "vorm. ", "replaceChar completes with spaces");

			//cleanup
			tp.destroy();
		});

		test("TimeSemanticMaskHelper.replaceChar any char completes am pm values to the first difference", function() {
			sinon.stub(sap.ui.core.LocaleData.prototype, "getDayPeriods").returns([ "MA", "MP"]);

			//system under test
			var tp = new sap.m.TimePicker({
				displayFormat: "hh a"
			});

			//arrange
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();


			var sCharReplaced = tp._oTimeSemanticMaskHelper.replaceChar("b", 3, "12 --");

			equals(sCharReplaced, "M", "replaceChar completes to the first difference");

			//cleanup
			sap.ui.core.LocaleData.prototype.getDayPeriods.restore();
			tp.destroy();
		});

		test("TimeSemanticMaskHelper.replaceChar correct char only completes am pm values on the position with difference", function() {
			sinon.stub(sap.ui.core.LocaleData.prototype, "getDayPeriods").returns([ "MABC", "MPBC"]);

			//system under test
			var tp = new sap.m.TimePicker({
				displayFormat: "hh a"
			});

			//arrange
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();


			var sCharReplaced = tp._oTimeSemanticMaskHelper.replaceChar("b", 4, "12 M---");

			equals(sCharReplaced, "b", "replaceChar does not replace invalid char");

			//cleanup
			sap.ui.core.LocaleData.prototype.getDayPeriods.restore();
			tp.destroy();
		});

		test("TimeSemanticMaskHelper.replaceChar completes am pm values on a middle position with difference, to the end", function() {
			sinon.stub(sap.ui.core.LocaleData.prototype, "getDayPeriods").returns([ "MABC", "MPBC"]);

			//system under test
			var tp = new sap.m.TimePicker({
				displayFormat: "hh a"
			});

			//arrange
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();


			var sCharReplaced = tp._oTimeSemanticMaskHelper.replaceChar("A", 4, "12 M---");

			equals(sCharReplaced, "ABC", "replaceChar completes when difference is in the middle");

			//cleanup
			sap.ui.core.LocaleData.prototype.getDayPeriods.restore();
			tp.destroy();
		});

		test("TimeSemanticMaskHelper.replaceChar autocomplete not case sensitive: a fills AM", function() {
			sinon.stub(sap.ui.core.LocaleData.prototype, "getDayPeriods").returns([ "AM", "PM"]);

			//system under test
			var tp = new sap.m.TimePicker({
				displayFormat: "hh a"
			});

			//arrange
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();


			var sCharReplaced = tp._oTimeSemanticMaskHelper.replaceChar("a", 3, "12 --");

			equals(sCharReplaced, "AM", "replaceChar is not case sensitive");

			//cleanup
			sap.ui.core.LocaleData.prototype.getDayPeriods.restore();
			tp.destroy();
		});

		//todo - test caret position

		module("events and event handlers", {
			beforeEach: function () {
				//system under test
				this.oTp = new sap.m.TimePicker({
					valueFormat: "hh mm",
					displayFormat: "hh mm"
				});
				this.oSpy = sinon.spy();
				this.oTp.attachChange(this.oSpy);

				//arrange
				this.oTp.placeAt("qunit-fixture");
				sap.ui.getCore().applyChanges();
			},
			afterEach: function() {
				this.oTp.destroy();
				this.oSpy = null;
			}
		});

		test("change event fires only when the value really changed", function() {
			//system under test
			var tp = new sap.m.TimePicker({
				valueFormat: "hh mm",
				value: "12 15"
			}), spy = {
					callCount: 0
			};

			tp.attachChange(function () {
				spy.callCount++;
			});

			//arrange
			tp.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			tp.fireChangeEvent("13 00");
			tp.fireChangeEvent("13 00");
			tp.fireChangeEvent("13 15");
			tp.fireChangeEvent("13 15");
			tp.fireChangeEvent("13 15");

			equals(spy.callCount, 2, "changed event fired only twice");

			spy = null;
			tp.destroy();
		});

		test("change event fires when the value is reset", function() {
			var oTpFocusDomRef = jQuery(this.oTp.getFocusDomRef());

			//system under test
			triggerMultipleKeypress(this.oTp, "09");
			qutils.triggerKeydown(oTpFocusDomRef, jQuery.sap.KeyCodes.ENTER);

			equals(this.oSpy.callCount, 1, "changed event fired when the value is set");

			while (oTpFocusDomRef.val() !== "-- --") {
				qutils.triggerKeydown(oTpFocusDomRef, jQuery.sap.KeyCodes.BACKSPACE);
			}
			qutils.triggerKeydown(oTpFocusDomRef, jQuery.sap.KeyCodes.ENTER);

			equals(this.oSpy.callCount, 2, "changed event fired when the value is reset");
		});

		test("upon enter, change event fires only once", function() {
			//act
			triggerMultipleKeypress(this.oTp, "09");
			qutils.triggerKeydown(jQuery(this.oTp.getFocusDomRef()), jQuery.sap.KeyCodes.ENTER);
			equals(this.oSpy.callCount, 1, "changed event must be fired only once");
		});

		test("upon focusin of timepicker input, no picker should be visible", function () {
			//arrange (open picker in order it to be initialized and rendered
			this.oTp._openPicker();
			this.clock.tick(1000);
			qutils.triggerEvent('focusin', this.oTp.getDomRef());
			this.clock.tick(1000);
			//assert
			ok(!this.oTp._getPicker().isOpen(), "The picker 'isOpen' state is false");
			ok(!this.oTp._getPicker().$().is(":visible"), "jQuery.is(':visible') returned false");
			strictEqual(this.oTp._getPicker().$().css('display'), 'none', "The picker css display property is none");
		});

		test("upon focusout, change event fires only once", function() {
			//system under test
			var	oTp2 = new sap.m.TimePicker({
					valueFormat: "hh mm"
			});
			//arrange
			oTp2.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			//act
			triggerMultipleKeypress(this.oTp, "09");
			jQuery(oTp2.getFocusDomRef()).focus();

			equals(this.oSpy.callCount, 1, "changed event must be fired only once");

			oTp2.destroy();
		});

		test("upon focusout, change event not fired when no value change", function() {
			//system under test
			var	oTp2 = new sap.m.TimePicker({
				valueFormat: "hh:mm"
			});
			//arrange
			this.oTp.setValue("07:15");
			oTp2.placeAt("content");
			sap.ui.getCore().applyChanges();

			//act
			jQuery(this.oTp.getFocusDomRef()).focus();
			jQuery(oTp2.getFocusDomRef()).focus();

			equals(this.oSpy.callCount, 0, "changed event must not be fired");

			oTp2.destroy();
		});


		function triggerMultipleKeypress(timePicker, sFeed) {
			var aFeed = sFeed.split(""),
					$TimePicker = timePicker.getDomRef(),
					sChar;

			while (aFeed.length) {
				sChar = aFeed.splice(0, 1)[0];
				qutils.triggerKeydown($TimePicker, sChar);
				qutils.triggerKeypress($TimePicker, sChar);
			}
		}

		module("Accessibility");

		test("getAccessibilityInfo", function() {
			var oInput = new sap.m.TimePicker({
				value: "Value",
				tooltip: "Tooltip",
				placeholder: "Placeholder"
			});
			ok(!!oInput.getAccessibilityInfo, "TimePicker has a getAccessibilityInfo function");
			var oInfo = oInput.getAccessibilityInfo();
			ok(!!oInfo, "getAccessibilityInfo returns a info object");
			strictEqual(oInfo.role, "combobox", "AriaRole");
			strictEqual(oInfo.type, sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("ACC_CTR_TYPE_TIMEINPUT"), "Type");
			strictEqual(oInfo.description, "Value Placeholder Tooltip", "Description");
			strictEqual(oInfo.focusable, true, "Focusable");
			strictEqual(oInfo.enabled, true, "Enabled");
			strictEqual(oInfo.editable, true, "Editable");
			oInput.setValue("");
			oInput.setEnabled(false);
			oInfo = oInput.getAccessibilityInfo();
			strictEqual(oInfo.description, "Placeholder Tooltip", "Description");
			strictEqual(oInfo.focusable, false, "Focusable");
			strictEqual(oInfo.enabled, false, "Enabled");
			strictEqual(oInfo.editable, false, "Editable");
			oInput.setEnabled(true);
			oInput.setEditable(false);
			oInfo = oInput.getAccessibilityInfo();
			strictEqual(oInfo.focusable, true, "Focusable");
			strictEqual(oInfo.enabled, true, "Enabled");
			strictEqual(oInfo.editable, false, "Editable");
			oInput.setValueFormat("HH.mm.ss");
			oInput.setDisplayFormat("HH-mm-ss");
			oInput.setValue("10.32.30");
			oInfo = oInput.getAccessibilityInfo();
			strictEqual(oInfo.description, "10-32-30 Placeholder Tooltip", "Description");
			oInput.destroy();
		});
	</script>

</head>
<body>
<h1 id="qunit-header">QUnit page for sap.m.TimePicker</h1>
<h2 id="qunit-banner"></h2>
<h2 id="qunit-userAgent"></h2>
<div id="qunit-testrunner-toolbar"></div>
<div id="qunit-fixture"></div>
<ol id="qunit-tests"></ol>
<div id="content"></div>
<br>
<div id="uiArea1"></div>
<br>
<div id="uiArea2"></div>
<br>
<div id="uiArea3"></div>
</body>
</html>


<!DOCTYPE HTML>

<!--
  Tested control/class: sap.m.DateTimeField
-->

<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>DateTimeField - sap.m</title>
	<link rel="shortcut icon" type="image/x-icon" href="../images/controls/sap.m.DatePicker.gif">
	<script src="../shared-config.js"></script>
	<script id="sap-ui-bootstrap"
			src="../../../../resources/sap-ui-core.js"
			data-sap-ui-noConflict="true"
			data-sap-ui-xx-bindingSyntax="complex"
			data-sap-ui-libs="sap.m"
			data-sap-ui-language="en-US">
	</script>
	<link rel="stylesheet" href="../../../../resources/sap/ui/thirdparty/qunit-2.css" type="text/css" media="screen">
	<script src="../../../../resources/sap/ui/thirdparty/qunit-2.js"></script>
	<script src="../../../../resources/sap/ui/qunit/qunit-junit.js"></script>
	<script src="../../../../resources/sap/ui/qunit/qunit-coverage.js"></script>
	<script src="../../../../resources/sap/ui/qunit/QUnitUtils.js"></script>
	<script src="../../../../resources/sap/ui/thirdparty/sinon.js"></script>
	<script src="../../../../resources/sap/ui/thirdparty/sinon-qunit.js"></script>
	<script src="../../../../resources/sap/ui/thirdparty/sinon-ie.js"></script>
</head>

<script>

	jQuery.sap.require("sap.m.DateTimeField");
	var DateTimeField = sap.m.DateTimeField;

	QUnit.module("Public API", function () {


		QUnit.module("displayFormat", function () {
			QUnit.test("Given DateTimeField, when I set displayFormat", function (assert) {
				var oSut = new DateTimeField({displayFormat: "medium"}),
					oSpyUpdatePlaceholder = this.spy(oSut, "_updateDomPlaceholder");

				// Act
				oSut.setDisplayFormat("short");

				// Assert
				assert.equal(oSpyUpdatePlaceholder.callCount, 1, "then function _updatePlaceholder should be called");

				// Cleanup
				oSut.destroy();
			});
		});

		QUnit.test("getDisplayedPlaceholder calls _getPlaceholder", function (assert) {
			// Prepare
			var oSut = new DateTimeField({displayFormat: "medium"}),
				oGetPlaceholderSpy = this.spy(oSut, "_getPlaceholder");

			// Act
			oSut.getDisplayedPlaceholder();

			// Assert
			assert.ok(oGetPlaceholderSpy.calledOnce, "_getPlaceholder is called when getDisplayedPlaceholder()");
			assert.equal(oSut._getPlaceholder(), oSut.getDisplayedPlaceholder(), "getDisplayedPlaceholder and _getPlaceholder()" +
					" returns same thing");

			// Cleanup
			oSut.destroy();
			oGetPlaceholderSpy.restore();
		});

		QUnit.test("Fake test to have a root module with at least one test, otherwise qunit-2 will fail", function (assert) {
			assert.ok(true, "assert ok");
		});
	});

	QUnit.module("Private API", function () {
		QUnit.test("Given DateTimeField, when I call _updateDomPlaceholder", function (assert) {
			// Prepare
			var oSut = new DateTimeField({displayFormat: "medium"});

			oSut.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			// Act
			oSut._updateDomPlaceholder("placeholder1");

			// Assert
			assert.equal(oSut.$().find("input").attr("placeholder"), "placeholder1",
				"the placeholder is changed with the provided one");

			// Cleanup
			oSut.destroy();
		});

		QUnit.test("if no placeholder is set, _getPlaceholder returns the used displayFormat", function (assert) {
			// Prepare
			var oSut = new DateTimeField({displayFormat: "yyyy-MM-dd"});

			// Assert
			assert.equal(oSut._getPlaceholder(), "yyyy-MM-dd", "the displayed placeholder is correct when there's no placeholder set");

			// Cleanup
			oSut.destroy();
		});

		QUnit.test("if a placeholder is set, _getPlaceholder returns it", function (assert) {
			// Prepare
			var oSut = new DateTimeField({placeholder: "placeholder"});

			// Assert
			assert.equal(oSut._getPlaceholder(), "placeholder", "the displayed placeholder is correct when there's a placeholder set");

			// Cleanup
			oSut.destroy();
		});
	});

</script>
<body class="sapUiBody" role="application">
<h1 id="qunit-header">QUnit tests: sap.m.DatePicker</h1>
<h2 id="qunit-banner"></h2>
<h2 id="qunit-userAgent"></h2>
<div id="qunit-testrunner-toolbar"></div>
<div id="qunit-fixture"></div>
</body>
</html>